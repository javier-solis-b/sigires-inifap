(function(){"use strict";var e={1517:function(e,a,r){var o={};r.r(o),r.d(o,{Q:function(){return es}});var t=r(5130),s=r(6768),n=r(6450),l=r(8477);function i(e,a,r,o,t,i){const c=(0,s.g2)("router-view");return(0,s.uX)(),(0,s.Wv)(n.E,null,{default:(0,s.k6)((()=>[(0,s.bF)(l.Y,null,{default:(0,s.k6)((()=>[(0,s.bF)(c)])),_:1})])),_:1})}var c=r(1387);class u{static set(e){localStorage.setItem("token",e)}static get(){return localStorage.getItem("token")}static clear(){return localStorage.removeItem("token")}}var d=r(4373);const m="https://backend-sigires-1.onrender.com/api/v1",p=d.A.create({baseURL:m});p.interceptors.request.use((e=>{const a=u.get();return a&&(e.headers.Authorization=a),e}));var b=p;const h=async(e,a,r)=>{if(console.log("üü£Ejecutando autenticaci√≥n"),!e.meta.requireAuth)return r();const o=u.get();if(!o)return r({name:"login"});const t=await b.get("token/verify");if(console.log("üü¢ response",t),!t.data.data.response)return r({name:"NoPermisos"});const s="true"===localStorage.getItem("isAdmin");if(e.meta.requireAdmin&&!s)return r({name:"NoPermisos"});r()};r(4114);var f=r(2807),v=r(5526),k=r(6756);const g=e=>((0,s.Qi)("data-v-eac8e4c0"),e=e(),(0,s.jt)(),e),_={class:"users-view"},L=g((()=>(0,s.Lk)("h3",{class:"fw-bold mb-0 text-color",style:{color:"#0c934a"}},"Usuarios",-1)));function y(e,a,r,o,t,n){const l=(0,s.g2)("UserDetails"),i=(0,s.g2)("paginate");return(0,s.uX)(),(0,s.CE)("div",_,[L,(0,s.Lk)("div",null,[(0,s.bF)(v.B,{class:"encabezado",style:{margin:"-10px"},cols:"12"})]),(0,s.bF)(k.L,null,{default:(0,s.k6)((()=>[(0,s.bF)(v.B,{cols:"12",style:{margin:"-1px",padding:"5px"}},{default:(0,s.k6)((()=>[(0,s.bF)(f.D,{class:"btn_add_user",onClick:a[0]||(a[0]=a=>e.$router.push({name:"usuarios.create"}))},{default:(0,s.k6)((()=>[(0,s.eW)(" + Crear nuevo usuario")])),_:1})])),_:1}),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.paginatedUsers,(e=>((0,s.uX)(),(0,s.Wv)(v.B,{key:e.id,cols:"10",sm:"10",md:"6",lg:"6"},{default:(0,s.k6)((()=>[(0,s.bF)(l,{user:e},null,8,["user"])])),_:2},1024)))),128))])),_:1}),(0,s.bF)(i,{"page-count":n.pageCount,"click-handler":n.handlePageClick,"prev-text":"Anterior","next-text":"Siguiente","container-class":"pagination"},null,8,["page-count","click-handler"])])}var w=r(4232),C=r(4593),F=r(1606),x=r(5832),E=r(3745);const V={class:"d-flex",style:{"justify-content":"center"}};function A(e,a,r,o,t,n){return t.display?((0,s.uX)(),(0,s.Wv)(C.J,{key:0,class:"elevation-6 pt-4",cols:"10",sm:"19",md:"4",lg:"2"},{default:(0,s.k6)((()=>[(0,s.Lk)("div",V,[(0,s.Lk)("div",{style:(0,w.Tr)(n.responsiveStyle)},null,4)]),(0,s.bF)(F.r,{class:"text-center",style:{padding:"0"}},{default:(0,s.k6)((()=>[(0,s.eW)((0,w.v_)(r.user.name??""),1)])),_:1}),(0,s.bF)(x.Z,{class:"text-center"},{default:(0,s.k6)((()=>[(0,s.eW)((0,w.v_)(1==r.user.isAdmin?"Administrador üü¢":"No es administrador‚ö´"),1)])),_:1}),(0,s.bF)(E.S,null,{default:(0,s.k6)((()=>[(0,s.bF)(k.L,null,{default:(0,s.k6)((()=>[(0,s.bF)(v.B,{cols:"6"},{default:(0,s.k6)((()=>[(0,s.Lk)("button",{type:"button",class:"btn btn-danger",style:{width:"100%"},onClick:a[0]||(a[0]=(...e)=>n.onDeleteUser&&n.onDeleteUser(...e))}," Eliminar ")])),_:1}),(0,s.bF)(v.B,{cols:"6"},{default:(0,s.k6)((()=>[(0,s.Lk)("button",{class:"btn btn-secondary",type:"button",style:{width:"100%"},onClick:a[1]||(a[1]=(...e)=>n.onEditUser&&n.onEditUser(...e))}," Editar ")])),_:1})])),_:1})])),_:1})])),_:1})):(0,s.Q3)("",!0)}var B=r(3374),S=r.n(B),$={props:{user:Object},data(){return{display:!0}},computed:{responsiveStyle(){return{width:"70px",height:"70px",background:"gray",borderRadius:"50%",backgroundImage:"url(/imagenes/admin.png)",backgroundSize:"contain"}}},methods:{async onDeleteUser(){const e=await S().fire({title:"¬øEst√°s seguro?",text:`¬øQuieres eliminar al usuario ${this.user.name}?`,icon:"warning",showCancelButton:!0,confirmButtonText:'<span style="color:white;">S√≠, eliminar</span>',cancelButtonText:'<span style="color:white;">Cancelar</span>'});e.isConfirmed&&(await b.delete(`usuarios/${this.user.id}`),this.$router.push("/usuarios"),this.display=!1,S().fire({icon:"success",title:"¬°Usuario eliminado exitosamente!",confirmButtonText:"OK"}).then((()=>{this.$router.push("/usuarios")})))},async onEditUser(){this.$router.push({name:"usuarios.edit",params:{id:this.user.id}})}}},R=r(1241);const q=(0,R.A)($,[["render",A],["__scopeId","data-v-3ee1ceb7"]]);var U=q;class I{static async all(){return(await b.get("usuarios")).data??[]}}var P=r(5881),T={data(){return{users:[],currentPage:1,perPage:10}},async mounted(){try{this.users=await I.all()}catch(e){console.error("Error loading users:",e)}},computed:{pageCount(){return Math.ceil(this.users.length/this.perPage)},paginatedUsers(){const e=(this.currentPage-1)*this.perPage,a=e+this.perPage;return this.users.slice(e,a)}},methods:{handlePageClick(e){this.currentPage=e}},components:{UserDetails:U,Paginate:P.A}};const D=(0,R.A)(T,[["render",y],["__scopeId","data-v-eac8e4c0"]]);var X=D;const M=e=>((0,s.Qi)("data-v-511dc718"),e=e(),(0,s.jt)(),e),W=M((()=>(0,s.Lk)("h3",{class:"fw-bold mb-0 text-color",style:{color:"#0c934a"}},"Inventario",-1))),O=M((()=>(0,s.Lk)("br",null,null,-1))),z={class:"mb-3 d-flex align-items-center"},j=M((()=>(0,s.Lk)("span",{class:"ms-2"},"Filtrar por tipo: ",-1))),N=M((()=>(0,s.Lk)("option",{value:"todos"},"Todos",-1))),Q=M((()=>(0,s.Lk)("option",{value:"solvente"},"Solventes",-1))),K=M((()=>(0,s.Lk)("option",{value:"reactivo"},"Reactivos",-1))),J=M((()=>(0,s.Lk)("option",{value:"soluci√≥n"},"Soluciones",-1))),G=[N,Q,K,J],H={class:"table table-striped"},Y=M((()=>(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",null,"ID"),(0,s.Lk)("th",null,"Almac√©n"),(0,s.Lk)("th",null,"No. inventario"),(0,s.Lk)("th",null,"Nombre"),(0,s.Lk)("th",null,"Tipo"),(0,s.Lk)("th",null,"F√≥rmula"),(0,s.Lk)("th",null,"Cantidad disponible"),(0,s.Lk)("th",null,"Recipientes"),(0,s.Lk)("th",null,"Caducidad")])],-1))),Z={class:"d-flex align-items-center"},ee={class:"d-flex ms-2 align-items-center"},ae=["onUpdate:modelValue"],re=["onClick","disabled"],oe=["onClick","disabled"],te={class:"d-flex align-items-center"},se={class:"d-flex ms-2 align-items-center"},ne=["onClick"],le=["onClick","disabled"],ie={key:0,class:"mt-3"};function ce(e,a,r,o,n,l){return(0,s.uX)(),(0,s.CE)("div",null,[W,O,(0,s.Lk)("div",z,[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>n.buscarPor=e),type:"text",placeholder:"Buscar por nombre...",class:"form-control w-50"},null,512),[[t.Jo,n.buscarPor]]),j,(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":a[1]||(a[1]=e=>n.filtroSeleccionado=e),class:"form-select me-2",onChange:a[2]||(a[2]=(...e)=>l.filtrarRecursos&&l.filtrarRecursos(...e))},G,544),[[t.u1,n.filtroSeleccionado]])]),(0,s.Lk)("table",H,[Y,(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.resultadosBusqueda,((e,a)=>((0,s.uX)(),(0,s.CE)("tr",{key:a,class:(0,w.C4)({"table-danger":e.capacidad_r<=0||e.recipientes_actuales<=0,"table-warning":e.capacidad_r>0&&e.capacidad_r<5})},[(0,s.Lk)("td",null,(0,w.v_)(e.id),1),(0,s.Lk)("td",null,(0,w.v_)(e.almacen||"-"),1),(0,s.Lk)("td",null,(0,w.v_)(e.no_inventario),1),(0,s.Lk)("td",null,(0,w.v_)(e.nombre),1),(0,s.Lk)("td",null,(0,w.v_)(e.tipo_recurso),1),(0,s.Lk)("td",null,(0,w.v_)(e.formula||"-"),1),(0,s.Lk)("td",null,[(0,s.Lk)("div",Z,[(0,s.eW)((0,w.v_)(e.capacidad_r)+" "+(0,w.v_)(e.unidad_medida)+" ",1),(0,s.Lk)("div",ee,[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":a=>e.cantidadInput=a,type:"number",min:"0",step:"0.01",class:(0,w.C4)(["form-control form-control-sm me-2",{"is-invalid":e.cantidadInput<0}]),placeholder:"Cantidad",style:{width:"90px"}},null,10,ae),[[t.Jo,e.cantidadInput,void 0,{number:!0}]]),(0,s.Lk)("button",{onClick:a=>l.actualizarCantidad(e.id,"sumar"),class:"btn btn-success btn-sm me-1",disabled:e.cantidadInput<=0}," + ",8,re),(0,s.Lk)("button",{onClick:a=>l.actualizarCantidad(e.id,"restar"),class:"btn btn-danger btn-sm",disabled:e.cantidadInput<=0}," - ",8,oe)])])]),(0,s.Lk)("td",null,[(0,s.Lk)("div",te,[(0,s.eW)((0,w.v_)(e.recipientes_actuales||"-")+" ",1),(0,s.Lk)("div",se,[(0,s.Lk)("button",{onClick:a=>l.actualizarRecipientes(e.id,"agregar"),class:"btn btn-success btn-sm me-1"}," + ",8,ne),(0,s.Lk)("button",{onClick:a=>l.actualizarRecipientes(e.id,"quitar"),class:"btn btn-danger btn-sm",disabled:e.recipientes_actuales<=0}," - ",8,le)])])]),(0,s.Lk)("td",null,(0,w.v_)(e.fecha_caducidad||"-"),1)],2)))),128))])]),n.resultadosBusqueda.length>0?((0,s.uX)(),(0,s.CE)("p",ie," Resultados de b√∫squeda: "+(0,w.v_)(n.resultadosBusqueda.length)+" recursos encontrados. ",1)):(0,s.Q3)("",!0)])}class ue{static async all(){const e=await b.get("/almacenes");return e.data??[]}}class de{static async all(){try{const e=await b.get("/recursos"),a=await ue.all(),r=new Map(a.map((e=>[e.id,e.nombre_almacen])));return e.data.map((e=>({...e,almacen:r.has(e.catalogo_id)?r.get(e.catalogo_id):"-"})))}catch(e){throw console.error("Error al cargar recursos:",e),e}}static async updateCapacidad(e,a,r){try{const o=await b.post(`/recursos/${e}/update-capacity`,{cantidad:a,accion:r});if(200===o.status)return o.data;throw new Error(`Error al actualizar capacidad: ${o.statusText}`)}catch(o){throw console.error("Error al actualizar capacidad:",o),o}}static async updateRecipientes(e,a){try{const r=await b.post(`/recursos/${e}/update-recipientes`,{accion:a});if(200===r.status)return r.data;throw new Error(`Error al actualizar recipientes: ${r.statusText}`)}catch(r){throw console.error("Error al actualizar recipientes:",r),r}}}var me={data(){return{recursos:[],buscarPor:"",filtroSeleccionado:"todos",resultadosBusqueda:[]}},setup(){const e=(0,s.EW)((()=>"true"===localStorage.getItem("isAdmin")));return{isAdmin:e}},async mounted(){await this.cargarRecursos()},methods:{async cargarRecursos(){try{const e=await de.all();this.recursos=e.map((e=>({...e,cantidadInput:0,recipientes_actuales:e.recipientes_actuales||0,capacidad_r:e.capacidad_r||0}))),this.resultadosBusqueda=[...this.recursos]}catch(e){console.error("Error al cargar recursos:",e),alert("Error al cargar los recursos. Por favor, int√©ntelo nuevamente.")}},async actualizarCantidad(e,a){const r=this.resultadosBusqueda.find((a=>a.id===e));if(!r)return void console.error("Recurso no encontrado");const o=Number(r.cantidadInput);if(isNaN(o))alert("Por favor ingrese un n√∫mero v√°lido");else if(o<=0)alert("La cantidad debe ser mayor que cero");else if("restar"===a&&o>r.capacidad_r)alert(`No puede quitar ${o} porque solo hay ${r.capacidad_r} en stock`);else try{const t="sumar"===a?r.capacidad_r+o:r.capacidad_r-o,s=await b.patch(`/recursos/${e}`,{capacidad_r:t});if(200!==s.status)throw new Error("Error al actualizar en el servidor");{r.capacidad_r=t,r.cantidadInput=0;const e="sumar"===a?"a√±adido":"quitado";alert(`Se ha ${e} ${o} ${r.unidad_medida} correctamente. Stock actual: ${t}`)}}catch(t){console.error("Error al actualizar cantidad:",t),alert("Error al actualizar la cantidad. Por favor, int√©ntelo nuevamente.")}},async actualizarRecipientes(e,a){const r=this.resultadosBusqueda.find((a=>a.id===e));if(!r)return void console.error("Recurso no encontrado");if("quitar"===a&&r.recipientes_actuales<=0)return void alert("No hay recipientes para quitar");const o=confirm(`¬øEst√° seguro que desea ${"agregar"===a?"agregar":"quitar"} un recipiente?`);if(o)try{const o="agregar"===a?r.recipientes_actuales+1:r.recipientes_actuales-1,t=await b.patch(`/recursos/${e}`,{recipientes_actuales:o});if(200!==t.status)throw new Error("Error al actualizar en el servidor");r.recipientes_actuales=o,alert(`Recipientes actualizados. Total: ${o}`)}catch(t){console.error("Error al actualizar recipientes:",t),alert("Error al actualizar los recipientes. Por favor, int√©ntelo nuevamente.")}},buscarPorNombre(){this.buscarPor.trim()?this.resultadosBusqueda=this.recursos.filter((e=>e.nombre.toLowerCase().includes(this.buscarPor.toLowerCase()))):this.resultadosBusqueda=[...this.recursos]},filtrarRecursos(){"todos"===this.filtroSeleccionado?this.buscarPorNombre():this.resultadosBusqueda=this.recursos.filter((e=>e.tipo_recurso.toLowerCase()===this.filtroSeleccionado&&e.nombre.toLowerCase().includes(this.buscarPor.toLowerCase())))}},watch:{buscarPor(){this.buscarPorNombre()},filtroSeleccionado(){this.filtrarRecursos()}}};const pe=(0,R.A)(me,[["render",ce],["__scopeId","data-v-511dc718"]]);var be=pe;const he=e=>((0,s.Qi)("data-v-a1717a2e"),e=e(),(0,s.jt)(),e),fe=he((()=>(0,s.Lk)("h3",{class:"fw-bold mb-0 text-color",style:{color:"#0c934a"}},"Recursos",-1))),ve=he((()=>(0,s.Lk)("br",null,null,-1))),ke={class:"mb-3 d-flex align-items-center"},ge=he((()=>(0,s.Lk)("span",{class:"ms-2"},"Filtrar por tipo: ",-1))),_e=he((()=>(0,s.Lk)("option",{value:"todos"},"Todos",-1))),Le=he((()=>(0,s.Lk)("option",{value:"solvente"},"Solventes",-1))),ye=he((()=>(0,s.Lk)("option",{value:"reactivo"},"Reactivos",-1))),we=he((()=>(0,s.Lk)("option",{value:"soluci√≥n"},"Soluciones",-1))),Ce=[_e,Le,ye,we],Fe={class:"table table-striped"},xe=he((()=>(0,s.Lk)("th",null,"ID",-1))),Ee=he((()=>(0,s.Lk)("th",null,"Almac√©n",-1))),Ve=he((()=>(0,s.Lk)("th",null,"No. inventario",-1))),Ae=he((()=>(0,s.Lk)("th",null,"Nombre",-1))),Be=he((()=>(0,s.Lk)("th",null,"Tipo",-1))),Se=he((()=>(0,s.Lk)("th",null,"Marca",-1))),$e=he((()=>(0,s.Lk)("th",null,"F√≥rmula",-1))),Re=he((()=>(0,s.Lk)("th",null,"PM",-1))),qe=he((()=>(0,s.Lk)("th",null,"Cantidad disponible",-1))),Ue=he((()=>(0,s.Lk)("th",null,"Recipientes",-1))),Ie=he((()=>(0,s.Lk)("th",null,"Lote",-1))),Pe=he((()=>(0,s.Lk)("th",null,"Caducidad",-1))),Te={key:0},De=["onClick"],Xe=["onClick"],Me={key:0,class:"mt-3"};function We(e,a,r,o,n,l){return(0,s.uX)(),(0,s.CE)("div",null,[fe,ve,(0,s.Lk)("div",ke,[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>n.buscarPor=e),type:"text",placeholder:"Buscar por nombre...",class:"form-control w-50"},null,512),[[t.Jo,n.buscarPor]]),ge,(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":a[1]||(a[1]=e=>n.filtroSeleccionado=e),class:"form-select me-2",onChange:a[2]||(a[2]=(...e)=>l.filtrarRecursos&&l.filtrarRecursos(...e))},Ce,544),[[t.u1,n.filtroSeleccionado]]),o.isAdmin?((0,s.uX)(),(0,s.CE)("button",{key:0,onClick:a[3]||(a[3]=a=>e.$router.push({name:"recursos.create"})),class:"btn btn-primary w-40 ms-2"}," + Agregar recurso ")):(0,s.Q3)("",!0)]),(0,s.Lk)("table",Fe,[(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[xe,Ee,Ve,Ae,Be,Se,$e,Re,qe,Ue,Ie,Pe,o.isAdmin?((0,s.uX)(),(0,s.CE)("th",Te,"Acciones")):(0,s.Q3)("",!0)])]),(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.resultadosBusqueda,((e,a)=>((0,s.uX)(),(0,s.CE)("tr",{key:a},[(0,s.Lk)("td",null,(0,w.v_)(e.id),1),(0,s.Lk)("td",null,(0,w.v_)(e.almacen||"-"),1),(0,s.Lk)("td",null,(0,w.v_)(e.no_inventario),1),(0,s.Lk)("td",null,(0,w.v_)(e.nombre),1),(0,s.Lk)("td",null,(0,w.v_)(e.tipo_recurso),1),(0,s.Lk)("td",null,(0,w.v_)(e.marca||"-"),1),(0,s.Lk)("td",null,(0,w.v_)(e.formula||"-"),1),(0,s.Lk)("td",null,(0,w.v_)(e.pm||"-"),1),(0,s.Lk)("td",null,(0,w.v_)(e.capacidad_r)+" "+(0,w.v_)(e.unidad_medida),1),(0,s.Lk)("td",null,(0,w.v_)(e.recipientes_actuales||"-"),1),(0,s.Lk)("td",null,(0,w.v_)(e.lote||"-"),1),(0,s.Lk)("td",null,(0,w.v_)(e.fecha_caducidad||"-"),1),(0,s.Lk)("td",null,[o.isAdmin?((0,s.uX)(),(0,s.CE)("button",{key:0,onClick:a=>l.editarResource(e),class:"btn btn-sm btn-warning mr-2"}," Editar ",8,De)):(0,s.Q3)("",!0),o.isAdmin?((0,s.uX)(),(0,s.CE)("button",{key:1,onClick:a=>l.eliminarRecurso(e),class:"btn btn-sm btn-danger"}," Eliminar ",8,Xe)):(0,s.Q3)("",!0)])])))),128))])]),n.resultadosBusqueda.length>0?((0,s.uX)(),(0,s.CE)("p",Me," Resultados de b√∫squeda: "+(0,w.v_)(n.resultadosBusqueda.length)+" recursos encontrados. ",1)):(0,s.Q3)("",!0)])}var Oe={data(){return{recursos:[],buscarPor:"",filtroSeleccionado:"todos",resultadosBusqueda:[]}},setup(){const e=(0,s.EW)((()=>"true"===localStorage.getItem("isAdmin")));return{isAdmin:e}},async mounted(){try{const e=await de.all();this.recursos=e,this.resultadosBusqueda=e}catch(e){console.error("Error al cargar recursos:",e),alert("Ha ocurrido un error al cargar los recursos. Por favor, int√©ntelo nuevamente.")}},methods:{editarResource(e){this.$router.push({name:"recursos.edit",params:{id:e.id}}),console.log("Editar recurso:",e)},async eliminarRecurso(e){const a=await S().fire({title:"¬øEst√°s seguro?",text:`¬øQuieres eliminar al recurso ${e.nombre}?`,icon:"warning",showCancelButton:!0,confirmButtonText:'<span style="color:white;">S√≠, eliminar</span>',cancelButtonText:'<span style="color:white;">Cancelar</span>'});if(a.isConfirmed)try{await b.delete(`recursos/${e.id}`),this.resultadosBusqueda=this.resultadosBusqueda.filter((a=>a.id!==e.id)),S().fire({icon:"success",title:"¬°Recurso eliminado exitosamente!",confirmButtonText:"OK"})}catch(r){console.error("Error al eliminar recurso:",r),r.response&&r.response.data?S().fire({icon:"error",title:"Error al eliminar recurso",text:r.response.data.message||"Ha ocurrido un error al intentar eliminar el recurso."}):S().fire({icon:"error",title:"Error al eliminar recurso",text:"Ha ocurrido un error al intentar eliminar el recurso."})}},buscarPorNombre(){this.buscarPor.trim()?this.resultadosBusqueda=this.recursos.filter((e=>e.nombre.toLowerCase().includes(this.buscarPor.toLowerCase()))):this.resultadosBusqueda=this.recursos,this.filtrarRecursos()},filtrarRecursos(){"todos"===this.filtroSeleccionado?this.resultadosBusqueda=this.recursos.filter((e=>e.nombre.toLowerCase().includes(this.buscarPor.toLowerCase()))):this.resultadosBusqueda=this.recursos.filter((e=>e.tipo_recurso.toLowerCase()===this.filtroSeleccionado&&e.nombre.toLowerCase().includes(this.buscarPor.toLowerCase())))}},watch:{buscarPor:{handler(){this.buscarPorNombre()},immediate:!0},filtroSeleccionado:{handler(){this.filtrarRecursos()},immediate:!0}}};const ze=(0,R.A)(Oe,[["render",We],["__scopeId","data-v-a1717a2e"]]);var je=ze,Ne=r(697),Qe=r(1772),Ke=r(1720);const Je=e=>((0,s.Qi)("data-v-2fb347c2"),e=e(),(0,s.jt)(),e),Ge={class:"container-fluid"},He=Je((()=>(0,s.Lk)("h3",{class:"fw-bold mb-3 text-color",style:{color:"#0c934a"}},"Almacenes",-1))),Ye={class:"d-flex align-items-center mb-3"},Ze={class:"table table-striped table-bordered text-center"},ea=Je((()=>(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",null,"ID"),(0,s.Lk)("th",null,"Almac√©n"),(0,s.Lk)("th",null,"Acciones")])],-1))),aa=["onClick"],ra=["onClick"],oa=["onClick"],ta={class:"table-responsive"},sa={class:"table table-striped table-bordered text-center"},na=Je((()=>(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",null,"ID"),(0,s.Lk)("th",null,"Almac√©n ID"),(0,s.Lk)("th",null,"No. de inventario"),(0,s.Lk)("th",null,"Nombre"),(0,s.Lk)("th",null,"Tipo"),(0,s.Lk)("th",null,"Marca"),(0,s.Lk)("th",null,"F√≥rmula"),(0,s.Lk)("th",null,"PM"),(0,s.Lk)("th",null,"Capacidad recip."),(0,s.Lk)("th",null,"Recipientes actuales"),(0,s.Lk)("th",null,"Lote")])],-1))),la={key:0,class:"mt-3"};function ia(e,a,r,o,n,l){return(0,s.uX)(),(0,s.CE)("div",Ge,[He,(0,s.Lk)("div",Ye,[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>n.buscarPor=e),type:"text",placeholder:"Buscar por nombre...",class:"form-control me-2"},null,512),[[t.Jo,n.buscarPor]]),o.isAdmin?((0,s.uX)(),(0,s.CE)("button",{key:0,onClick:a[1]||(a[1]=a=>e.$router.push({name:"almacenes.create"})),class:"btn btn-primary"}," + Crear nuevo Almac√©n ")):(0,s.Q3)("",!0)]),(0,s.Lk)("table",Ze,[ea,(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.resultadosBusqueda,((e,a)=>((0,s.uX)(),(0,s.CE)("tr",{key:a},[(0,s.Lk)("td",null,(0,w.v_)(e.id),1),(0,s.Lk)("td",null,(0,w.v_)(e.nombre_almacen||"-"),1),(0,s.Lk)("td",null,[(0,s.Lk)("button",{onClick:a=>l.verContenidoAlmacen(e.id),class:"btn btn-sm btn-success me-2"}," Ver contenido de este almac√©n ",8,aa),o.isAdmin?((0,s.uX)(),(0,s.CE)("button",{key:0,onClick:a=>l.editarAlmacen(e),class:"btn btn-sm btn-warning me-2"}," Editar ",8,ra)):(0,s.Q3)("",!0),o.isAdmin?((0,s.uX)(),(0,s.CE)("button",{key:1,onClick:a=>l.eliminarAlmacen(e),class:"btn btn-sm btn-danger"}," Eliminar ",8,oa)):(0,s.Q3)("",!0)])])))),128))])]),(0,s.bF)(Qe.p,{modelValue:n.verModal,"onUpdate:modelValue":a[2]||(a[2]=e=>n.verModal=e),"max-width":"1200px"},{default:(0,s.k6)((()=>[(0,s.bF)(C.J,null,{default:(0,s.k6)((()=>[(0,s.bF)(F.r,null,{default:(0,s.k6)((()=>[(0,s.eW)(" Contenido del Almac√©n ")])),_:1}),(0,s.bF)(Ne.O,null,{default:(0,s.k6)((()=>[(0,s.Lk)("div",ta,[(0,s.Lk)("table",sa,[na,(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.recursosAlmacen,((e,a)=>((0,s.uX)(),(0,s.CE)("tr",{key:a},[(0,s.Lk)("td",null,(0,w.v_)(e.id),1),(0,s.Lk)("td",null,(0,w.v_)(e.catalogo_id),1),(0,s.Lk)("td",null,(0,w.v_)(e.no_inventario),1),(0,s.Lk)("td",null,(0,w.v_)(e.nombre),1),(0,s.Lk)("td",null,(0,w.v_)(e.tipo_recurso),1),(0,s.Lk)("td",null,(0,w.v_)(e.marca||"-"),1),(0,s.Lk)("td",null,(0,w.v_)(e.formula||"-"),1),(0,s.Lk)("td",null,(0,w.v_)(e.pm||"-"),1),(0,s.Lk)("td",null,(0,w.v_)(e.capacidad_r),1),(0,s.Lk)("td",null,(0,w.v_)(e.recipientes_actuales||"-"),1),(0,s.Lk)("td",null,(0,w.v_)(e.lote||"-"),1)])))),128))])])])])),_:1}),(0,s.bF)(E.S,null,{default:(0,s.k6)((()=>[(0,s.bF)(Ke.h),(0,s.bF)(f.D,{color:"primary",onClick:l.cerrarModal},{default:(0,s.k6)((()=>[(0,s.eW)("Cerrar")])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),n.resultadosBusqueda.length>0?((0,s.uX)(),(0,s.CE)("p",la," Resultados de b√∫squeda: "+(0,w.v_)(n.resultadosBusqueda.length)+" almacenes encontrados. ",1)):(0,s.Q3)("",!0)])}var ca={data(){return{almacenes:[],buscarPor:"",resultadosBusqueda:[],verModal:!1,recursosAlmacen:[]}},setup(){const e=(0,s.EW)((()=>"true"===localStorage.getItem("isAdmin")));return{isAdmin:e}},async mounted(){this.cargarAlmacenes()},methods:{async cargarAlmacenes(){try{const e=await ue.all();this.almacenes=e,this.resultadosBusqueda=e}catch(e){console.error("Error al cargar almacenes:",e),alert("Ha ocurrido un error al cargar los almacenes. Por favor, int√©ntelo nuevamente.")}},verAlmacen(e){console.log("Ver contenido del almac√©n:",e)},editarAlmacen(e){console.log("Editar almac√©n:",e),this.$router.push({name:"almacenes.edit",params:{id:e.id}})},async eliminarAlmacen(e){const a=await S().fire({title:"¬øEst√°s seguro?",text:`¬øQuieres eliminar el almacen ${e.nombre_almacen}?`,icon:"warning",showCancelButton:!0,confirmButtonText:'<span style="color:white;">S√≠, eliminar</span>',cancelButtonText:'<span style="color:white;">Cancelar</span>'});if(a.isConfirmed)try{await b.delete(`almacenes/${e.id}`),this.resultadosBusqueda=this.resultadosBusqueda.filter((a=>a.id!==e.id)),S().fire({icon:"success",title:"¬°Almacen eliminado exitosamente!",confirmButtonText:"OK"})}catch(r){console.error("Error al eliminar recurso:",r),S().fire({icon:"error",title:"Error al eliminar almacen",text:"NO se puede eliminar el almacen debido a que tiene recursos u otra tabla relacionada."})}},buscarPorNombre(){this.buscarPor.trim()?this.resultadosBusqueda=this.almacenes.filter((e=>e.nombre_almacen.toLowerCase().includes(this.buscarPor.toLowerCase()))):this.resultadosBusqueda=this.almacenes},async verContenidoAlmacen(e){try{const a=await de.all();this.recursosAlmacen=a.filter((a=>a.catalogo_id===e)),this.verModal=!0}catch(a){console.error("Error al cargar los recursos del almac√©n:",a),alert("Ha ocurrido un error al cargar los recursos del almac√©n. Por favor, int√©ntelo nuevamente.")}},cerrarModal(){this.verModal=!1}},watch:{buscarPor:{handler(){this.buscarPorNombre()},immediate:!0}}};const ua=(0,R.A)(ca,[["render",ia],["__scopeId","data-v-2fb347c2"]]);var da=ua;const ma=e=>((0,s.Qi)("data-v-8e73c550"),e=e(),(0,s.jt)(),e),pa={class:"container-fluid"},ba=ma((()=>(0,s.Lk)("h3",{class:"fw-bold mb-3 text-color",style:{color:"#0c934a"}}," Soluciones Stock y Recursos ",-1))),ha={class:"d-flex align-items-center mb-3"},fa=ma((()=>(0,s.Lk)("option",{value:""},"Todos los medios de cultivo",-1))),va=["value"],ka={class:"table"},ga=ma((()=>(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",null,"ID"),(0,s.Lk)("th",null,"Medio de cultivo"),(0,s.Lk)("th",null,"Nombre de la Soluci√≥n"),(0,s.Lk)("th",null,"Recursos"),(0,s.Lk)("th",null,"Acciones")])],-1))),_a=["onClick"],La=["onClick"],ya=["onClick"];function wa(e,a,r,o,n,l){return(0,s.uX)(),(0,s.CE)("div",pa,[ba,(0,s.Lk)("div",ha,[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>o.buscarPor=e),type:"text",placeholder:"Buscar por nombre de la soluci√≥n...",class:"form-control me-2"},null,512),[[t.Jo,o.buscarPor]]),(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":a[1]||(a[1]=e=>o.filtroMedioCultivo=e),class:"form-control me-2"},[fa,((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(o.mediosCultivoUnicos,(e=>((0,s.uX)(),(0,s.CE)("option",{key:e,value:e},(0,w.v_)(e||"Sin medio de cultivo"),9,va)))),128))],512),[[t.u1,o.filtroMedioCultivo]]),o.isAdmin?((0,s.uX)(),(0,s.CE)("button",{key:0,onClick:a[2]||(a[2]=a=>e.$router.push({name:"solucioness.create"})),class:"btn btn-primary"}," + Crear soluci√≥n stock ")):(0,s.Q3)("",!0)]),(0,s.Lk)("table",ka,[ga,(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(o.solucionesFiltradas,(a=>((0,s.uX)(),(0,s.CE)("tr",{key:a.id},[(0,s.Lk)("td",null,(0,w.v_)(a.id),1),(0,s.Lk)("td",null,(0,w.v_)(a.medios_cultivo),1),(0,s.Lk)("td",null,(0,w.v_)(a.nombre_solucion),1),(0,s.Lk)("td",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.recursos,(e=>((0,s.uX)(),(0,s.CE)("div",{key:e.id,style:{color:"#5a5a5a"}},(0,w.v_)(e.nombre)+": "+(0,w.v_)(o.convertirUnidad(e.cantidad_usada,e.unidad_medida)),1)))),128))]),(0,s.Lk)("td",null,[(0,s.Lk)("button",{onClick:e=>o.usarSolucion(a.id),class:"btn btn-success me-2"}," Usar esta soluci√≥n ",8,_a),(0,s.Lk)("button",{onClick:r=>e.$router.push({name:"soluciones.edit",params:{id:a.id}}),class:"btn btn-warning me-2",style:{"background-color":"yellow"}}," Editar ",8,La),(0,s.Lk)("button",{onClick:e=>o.eliminarSolucion(a.id),class:"btn btn-danger me-2"}," Eliminar ",8,ya)])])))),128))])])])}r(3375),r(9225),r(3972),r(9209),r(5714),r(7561),r(6197);var Ca=r(144);class Fa{static async all(){const e=await b.get("/soluciones");return e.data??[]}static async getWithResources(e){const a=await b.get(`/soluciones/${e}/recursos`);return a.data}static async create(e){const a=await b.post("/soluciones",e);return a.data}static async update(e,a){const r=await b.put(`/soluciones/${e}`,a);return r.data}static async delete(e){const a=await b.delete(`/soluciones/${e}`);return a.data}static async usarSolucion(e){try{const a=await b.post(`/soluciones/${e}/usar`);return a.data}catch(a){if(a.response&&400===a.response.status)throw a.response.data;throw a}}}class xa{static async all(){try{const e=await b.get("/soluciones-recursos"),a=await de.all(),r=new Map(a.map((e=>[e.id,e.nombre])));return e.data.map((e=>({...e,nombre:r.get(e.recurso_id)||"Recurso no encontrado"})))}catch(e){throw console.error("Error al cargar soluciones y recursos:",e),e}}}var Ea=r(7411),Va={setup(){const e=(0,s.EW)((()=>"true"===localStorage.getItem("isAdmin"))),a=(0,Ca.KR)(""),r=(0,Ca.KR)([]),o=(0,Ca.KR)(""),t=(0,Ea.dj)(),n=(0,s.EW)((()=>{const e=new Set;return r.value.forEach((a=>{a.medios_cultivo&&e.add(a.medios_cultivo)})),Array.from(e).sort()})),l=async()=>{try{const e=await Fa.all(),a=await xa.all();r.value=e.map((e=>(e.recursos=a.filter((a=>a.solucion_id===e.id)),e)))}catch(e){console.error("Error fetching soluciones with recursos:",e),t.error("Error al cargar las soluciones y recursos")}},i=async e=>{const a=await S().fire({title:"¬øEst√°s seguro?",text:"¬°No podr√°s revertir esto!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"S√≠, eliminar",cancelButtonText:"Cancelar",customClass:{confirmButton:"swal2-confirm",cancelButton:"swal2-cancel"}});if(a.isConfirmed)try{await Fa.delete(e),S().fire("¬°Eliminado!","La soluci√≥n ha sido eliminada.","success"),l()}catch(r){console.error("Error al eliminar la soluci√≥n:",r),S().fire("Error","No se pudo eliminar la soluci√≥n.","error")}},c=async e=>{try{const a=await S().fire({title:"¬øUsar esta soluci√≥n?",text:"¬øEst√°s seguro de que deseas usar esta soluci√≥n?",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"S√≠, usar",cancelButtonText:"Cancelar"});a.isConfirmed&&(await Fa.usarSolucion(e),S().fire("¬°√âxito!","La soluci√≥n ha sido usada correctamente.","success"),l())}catch(a){a.message?S().fire({title:"No se puede usar la soluci√≥n",html:`<strong>${a.message}</strong><br>\n               Disponible: ${a.disponible} ${a.unidad_medida||""}<br>\n               Requerido: ${a.requerido} ${a.unidad_medida||""}`,icon:"error"}):(S().fire("Error","Ocurri√≥ un error al usar la soluci√≥n.","error"),console.error("Error al usar soluci√≥n:",a))}},u=(0,s.EW)((()=>r.value.filter((e=>{const r=!a.value||e.nombre_solucion.toLowerCase().includes(a.value.toLowerCase()),t=!o.value||e.medios_cultivo===o.value;return r&&t}))));(0,s.sV)(l);const d=(e,a)=>{const r=["litros","mililitros","microlitros"],o=["kilogramos","gramos","miligramos","microgramos"];if(r.includes(a))switch(a){case"litros":return`${e} L`;case"mililitros":return`${e} mL`;case"microlitros":return`${e} ¬µL`;default:return`${e}`}else{if(!o.includes(a))return`${e}`;switch(a){case"kilogramos":return`${e} kg`;case"gramos":return`${e} g`;case"miligramos":return`${e} mg`;case"microgramos":return`${e} ¬µg`;default:return`${e}`}}};return{isAdmin:e,buscarPor:a,soluciones:r,filtroMedioCultivo:o,mediosCultivoUnicos:n,solucionesFiltradas:u,usarSolucion:c,eliminarSolucion:i,convertirUnidad:d}}};const Aa=(0,R.A)(Va,[["render",wa],["__scopeId","data-v-8e73c550"]]);var Ba=Aa,Sa=r(276),$a=r(1560),Ra=r(3813),qa=r(5728);const Ua=e=>((0,s.Qi)("data-v-728f44c4"),e=e(),(0,s.jt)(),e),Ia=Ua((()=>(0,s.Lk)("link",{rel:"stylesheet",href:"https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"},null,-1))),Pa=Ua((()=>(0,s.Lk)("span",{class:"material-symbols-outlined"}," arrow_back ",-1))),Ta=Ua((()=>(0,s.Lk)("h3",{class:"fw-bold mb-3"},"Crear un nuevo usuario",-1)));function Da(e,a,r,o,n,l){return(0,s.uX)(),(0,s.Wv)($a.n,{onSubmit:(0,t.D$)(l.onSubmit,["prevent"])},{default:(0,s.k6)((()=>[Ia,(0,s.Lk)("div",null,[(0,s.bF)(f.D,{icon:"",onClick:a[0]||(a[0]=a=>e.$router.push("/usuarios"))},{default:(0,s.k6)((()=>[Pa])),_:1}),(0,s.bF)(v.B,{class:"encabezado",style:{margin:"-10px"},cols:"12"},{default:(0,s.k6)((()=>[Ta])),_:1})]),(0,s.bF)(C.J,null,{default:(0,s.k6)((()=>[(0,s.bF)(Ra.I,null,{default:(0,s.k6)((()=>[(0,s.bF)(k.L,null,{default:(0,s.k6)((()=>[(0,s.bF)(v.B,{cols:"12",sm:"24",md:"12"},{default:(0,s.k6)((()=>[(0,s.bF)(qa.W,{variant:"underlined",modelValue:n.name,"onUpdate:modelValue":a[1]||(a[1]=e=>n.name=e),label:"Usuario","prepend-icon":"mdi-account",required:""},null,8,["modelValue"])])),_:1}),(0,s.bF)(v.B,{cols:"12",sm:"24",md:"12"},{default:(0,s.k6)((()=>[(0,s.bF)(qa.W,{modelValue:n.password,"onUpdate:modelValue":a[2]||(a[2]=e=>n.password=e),type:"password",label:"Contrase√±a",variant:"underlined","prepend-icon":"mdi-lock",required:""},null,8,["modelValue"])])),_:1}),(0,s.bF)(v.B,{cols:"12",sm:"24",md:"12"},{default:(0,s.k6)((()=>[(0,s.bF)(qa.W,{variant:"underlined",modelValue:n.repeatedPassword,"onUpdate:modelValue":a[3]||(a[3]=e=>n.repeatedPassword=e),type:"password",label:"Verificar contrase√±a","prepend-icon":"mdi-lock",required:""},null,8,["modelValue"])])),_:1}),(0,s.bF)(v.B,{cols:"12",sm:"24",md:"12"},{default:(0,s.k6)((()=>[(0,s.bF)(Sa.a,{modelValue:n.isAdmin,"onUpdate:modelValue":a[4]||(a[4]=e=>n.isAdmin=e),label:"¬øEste usuario es un administrador?","true-value":"true","false-value":"false"},null,8,["modelValue"])])),_:1}),(0,s.bF)(v.B,{cols:"12",sm:"24",md:"12"},{default:(0,s.k6)((()=>[(0,s.bF)(f.D,{type:"submit",color:"primary"},{default:(0,s.k6)((()=>[(0,s.eW)(" Crear usuario. ")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["onSubmit"])}var Xa={data(){return{name:"",password:"",repeatedPassword:"",isAdmin:null}},methods:{async onSubmit(){if(!this.name||!this.password||!this.repeatedPassword)return void S().fire({icon:"warning",title:"Completa todos los campos",text:"Por favor, aseg√∫rate de llenar todos los campos requeridos.",confirmButtonText:'<span style="color:white;">ok</span>'});if(this.password!==this.repeatedPassword)return void S().fire({icon:"error",title:"Error",text:"Las contrase√±as no coinciden",confirmButtonText:'<span style="color:white;">ok</span>'});const e=this.isAdmin?1:0;try{await b.post("usuarios",{name:this.name,password:this.password,isAdmin:e}),S().fire({icon:"success",title:"Usuario creado con √©xito",text:"El nuevo usuario ha sido creado correctamente.",confirmButtonText:'<span style="color:white;">ok</span>'}),this.$router.push({name:"usuarios"}),console.log({name:this.name,password:this.password,repeatedPassword:this.repeatedPassword,isAdmin:e})}catch(a){console.error("Error al crear el usuario:",a.response.data),S().fire({icon:"error",title:"Error al crear el usuario",text:"Hubo un problema al crear el usuario. Por favor, int√©ntalo de nuevo.",confirmButtonText:'<span style="color:white;">ok</span>'})}}}};const Ma=(0,R.A)(Xa,[["render",Da],["__scopeId","data-v-728f44c4"]]);var Wa=Ma,Oa=r(7150);const za=(0,s.Lk)("link",{rel:"stylesheet",href:"https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"},null,-1),ja=(0,s.Lk)("span",{class:"material-symbols-outlined"},"arrow_back",-1),Na=(0,s.Lk)("h3",{class:"fw-bold mb-3"},"Crear un nuevo recurso",-1);function Qa(e,a,r,o,n,l){return(0,s.uX)(),(0,s.Wv)($a.n,{onSubmit:(0,t.D$)(l.onSubmit,["prevent"])},{default:(0,s.k6)((()=>[za,(0,s.Lk)("div",null,[(0,s.bF)(f.D,{icon:"",onClick:a[0]||(a[0]=a=>e.$router.back())},{default:(0,s.k6)((()=>[ja])),_:1}),(0,s.bF)(v.B,{class:"encabezado",style:{margin:"-10px"},cols:"12"},{default:(0,s.k6)((()=>[Na])),_:1})]),(0,s.bF)(C.J,null,{default:(0,s.k6)((()=>[(0,s.bF)(Ra.I,null,{default:(0,s.k6)((()=>[(0,s.bF)(k.L,null,{default:(0,s.k6)((()=>[(0,s.bF)(v.B,{cols:"12",sm:"6",md:"4"},{default:(0,s.k6)((()=>[(0,s.bF)(Oa.d4,{modelValue:n.catalogo_id,"onUpdate:modelValue":a[1]||(a[1]=e=>n.catalogo_id=e),items:n.catalogos,"item-title":"text","item-value":"value",label:"Almacen",variant:"underlined","prepend-icon":"mdi-storefront",required:"",onInput:l.actualizarCatalogoId,onChange:l.onChangeCatalogo},null,8,["modelValue","items","onInput","onChange"])])),_:1}),(0,s.bF)(v.B,{cols:"12",sm:"6",md:"4"},{default:(0,s.k6)((()=>[(0,s.bF)(qa.W,{variant:"underlined",modelValue:n.no_inventario,"onUpdate:modelValue":a[2]||(a[2]=e=>n.no_inventario=e),label:"No. de inventario","prepend-icon":"mdi-format-list-numbered",required:""},null,8,["modelValue"])])),_:1}),(0,s.bF)(v.B,{cols:"12",sm:"6",md:"4"},{default:(0,s.k6)((()=>[(0,s.bF)(qa.W,{variant:"underlined",modelValue:n.nombre,"onUpdate:modelValue":a[3]||(a[3]=e=>n.nombre=e),label:"Nombre","prepend-icon":"mdi-label",required:""},null,8,["modelValue"])])),_:1}),(0,s.bF)(v.B,{cols:"12",sm:"6",md:"4"},{default:(0,s.k6)((()=>[(0,s.bF)(Oa.d4,{modelValue:n.tipo_recurso,"onUpdate:modelValue":a[4]||(a[4]=e=>n.tipo_recurso=e),items:["Reactivo","Soluci√≥n","Solvente"],label:"Tipo de recurso",variant:"underlined","prepend-icon":"mdi-sort",required:""},null,8,["modelValue"])])),_:1}),(0,s.bF)(v.B,{cols:"12",sm:"6",md:"4"},{default:(0,s.k6)((()=>[(0,s.bF)(qa.W,{variant:"underlined",modelValue:n.marca,"onUpdate:modelValue":a[5]||(a[5]=e=>n.marca=e),label:"Marca","prepend-icon":"mdi-tag",required:""},null,8,["modelValue"])])),_:1}),(0,s.bF)(v.B,{cols:"12",sm:"6",md:"4"},{default:(0,s.k6)((()=>[(0,s.bF)(qa.W,{modelValue:n.formula,"onUpdate:modelValue":a[6]||(a[6]=e=>n.formula=e),label:"F√≥rmula",variant:"underlined",rows:"3","prepend-icon":"mdi-molecule",required:""},null,8,["modelValue"])])),_:1}),(0,s.bF)(v.B,{cols:"12",sm:"6",md:"4"},{default:(0,s.k6)((()=>[(0,s.bF)(qa.W,{variant:"underlined",modelValue:n.pm,"onUpdate:modelValue":a[7]||(a[7]=e=>n.pm=e),label:"PM","prepend-icon":"mdi-wrench",required:""},null,8,["modelValue"])])),_:1}),(0,s.bF)(v.B,{cols:"12",sm:"6",md:"4"},{default:(0,s.k6)((()=>[(0,s.bF)(qa.W,{variant:"underlined",modelValue:n.capacidad_r,"onUpdate:modelValue":a[8]||(a[8]=e=>n.capacidad_r=e),label:"Cantidad disponible.",type:"number","prepend-icon":"mdi-barrel",required:""},null,8,["modelValue"])])),_:1}),(0,s.bF)(v.B,{cols:"12",sm:"6",md:"4"},{default:(0,s.k6)((()=>[(0,s.bF)(Oa.d4,{modelValue:n.unidad_medida,"onUpdate:modelValue":a[9]||(a[9]=e=>n.unidad_medida=e),items:n.unidadesMedida,label:"Unidad de medida",variant:"underlined","prepend-icon":"mdi-ruler-square",required:""},null,8,["modelValue","items"])])),_:1}),(0,s.bF)(v.B,{cols:"12",sm:"6",md:"4"},{default:(0,s.k6)((()=>[(0,s.bF)(qa.W,{variant:"underlined",modelValue:n.recipientes_actuales,"onUpdate:modelValue":a[10]||(a[10]=e=>n.recipientes_actuales=e),label:"Recipientes actuales",type:"number","prepend-icon":"mdi-cup",required:""},null,8,["modelValue"])])),_:1}),(0,s.bF)(v.B,{cols:"12",sm:"6",md:"4"},{default:(0,s.k6)((()=>[(0,s.bF)(qa.W,{variant:"underlined",modelValue:n.lote,"onUpdate:modelValue":a[11]||(a[11]=e=>n.lote=e),label:"Lote","prepend-icon":"mdi-barcode",required:""},null,8,["modelValue"])])),_:1}),(0,s.bF)(v.B,{cols:"12",sm:"6",md:"4"},{default:(0,s.k6)((()=>[(0,s.bF)(qa.W,{variant:"underlined",modelValue:n.fecha_caducidad,"onUpdate:modelValue":a[12]||(a[12]=e=>n.fecha_caducidad=e),label:"Fecha de caducidad",type:"date","prepend-icon":"mdi-calendar-range",required:""},null,8,["modelValue"])])),_:1})])),_:1}),(0,s.bF)(k.L,{justify:"start",align:"center",class:"mt-4"},{default:(0,s.k6)((()=>[(0,s.bF)(v.B,{cols:"auto"},{default:(0,s.k6)((()=>[(0,s.bF)(f.D,{type:"submit",color:"primary"},{default:(0,s.k6)((()=>[(0,s.eW)("Crear recurso.")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["onSubmit"])}var Ka=r(794),Ja={data(){return{nombre:"",tipo_recurso:"",no_inventario:"",marca:"",pm:"",formula:"",capacidad_r:"",lote:"",recipientes_actuales:"",catalogos:[],nombre_almacen:"",catalogo_id:null,fecha_caducidad:null,unidad_medida:"",unidadesMedida:["mililitros","microlitros","mililitros","kilogramos","gramos","miligramos","microgramos"]}},async mounted(){await this.cargarCatalogos(),console.log("catalogo_id antes de enviar:",this.catalogo_id)},methods:{async cargarCatalogos(){try{const e=await ue.all();this.catalogos=e.map((e=>({value:e.catalogo_id,text:`${e.id} - ${e.nombre_almacen}`})))}catch(e){console.error("Error al cargar los almacenes:",e),S().fire({icon:"error",title:"Error al cargar almacenes",text:"Hubo un problema al cargar los almacenes. Por favor, int√©ntalo de nuevo.",confirmButtonText:'<span style="color:white;">OK</span>'})}},actualizarCatalogoId(e){console.log("Valor seleccionado:",e.target.value),this.catalogo_id=e.target.value},onChangeCatalogo(e){console.log("Valor seleccionado:",e),this.catalogo_id=e},async onSubmit(){if(this.nombre&&this.tipo_recurso&&this.no_inventario)if(this.catalogo_id)try{const e=(0,Ka.A)(),a=await b.post("recursos",{id:e,nombre:this.nombre,tipo_recurso:this.tipo_recurso,no_inventario:this.no_inventario,marca:this.marca,pm:parseFloat(this.pm),formula:this.formula,capacidad_r:parseInt(this.capacidad_r),lote:this.lote,recipientes_actuales:parseInt(this.recipientes_actuales),catalogo_id:parseInt(this.catalogo_id),fecha_caducidad:this.fecha_caducidad?new Date(this.fecha_caducidad).toISOString().split("T")[0]:null,unidad_medida:this.unidad_medida});console.log(a.data),S().fire({icon:"success",title:"Recurso creado con √©xito",text:"El recurso ha sido creado exitosamente.",confirmButtonText:'<span style="color:white;">OK</span>'}),this.$router.push({name:"recursos"})}catch(e){console.error("Error al crear el recurso:",e.response?.data||e.message),S().fire({icon:"error",title:"Error al crear el recurso",text:"Hubo un problema al crear el recurso. Por favor, int√©ntalo de nuevo.",confirmButtonText:'<span style="color:white;">OK</span>'})}else S().fire({icon:"error",title:"Error",text:"Seleccione un almacen",confirmButtonText:'<span style="color:white;">OK</span>'});else S().fire({icon:"warning",title:"Completa todos los campos",text:"Por favor, aseg√∫rate de llenar todos los campos requeridos.",confirmButtonText:'<span style="color:white;">OK</span>'})}}};const Ga=(0,R.A)(Ja,[["render",Qa]]);var Ha=Ga;const Ya=e=>((0,s.Qi)("data-v-122afea8"),e=e(),(0,s.jt)(),e),Za=Ya((()=>(0,s.Lk)("link",{rel:"stylesheet",href:"https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"},null,-1))),er=Ya((()=>(0,s.Lk)("span",{class:"material-symbols-outlined"}," arrow_back ",-1))),ar=Ya((()=>(0,s.Lk)("h3",{class:"fw-bold mb-3"},"Crear un nuevo almac√©n",-1)));function rr(e,a,r,o,n,l){return(0,s.uX)(),(0,s.Wv)($a.n,{onSubmit:(0,t.D$)(l.onSubmit,["prevent"])},{default:(0,s.k6)((()=>[Za,(0,s.Lk)("div",null,[(0,s.bF)(f.D,{icon:"",onClick:a[0]||(a[0]=a=>e.$router.push("/almacenes"))},{default:(0,s.k6)((()=>[er])),_:1}),(0,s.bF)(v.B,{class:"encabezado",style:{margin:"-10px"},cols:"12"},{default:(0,s.k6)((()=>[ar])),_:1})]),(0,s.bF)(C.J,null,{default:(0,s.k6)((()=>[(0,s.bF)(Ra.I,null,{default:(0,s.k6)((()=>[(0,s.bF)(k.L,null,{default:(0,s.k6)((()=>[(0,s.bF)(v.B,{cols:"12",sm:"24",md:"12"},{default:(0,s.k6)((()=>[(0,s.bF)(qa.W,{variant:"underlined",modelValue:n.nombre_almacen,"onUpdate:modelValue":a[1]||(a[1]=e=>n.nombre_almacen=e),label:"Nombre del almac√©n","prepend-icon":"mdi-warehouse",required:""},null,8,["modelValue"])])),_:1}),(0,s.bF)(v.B,{cols:"12",sm:"24",md:"12"},{default:(0,s.k6)((()=>[(0,s.bF)(f.D,{type:"submit",color:"primary"},{default:(0,s.k6)((()=>[(0,s.eW)(" Crear almac√©n ")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["onSubmit"])}var or={data(){return{nombre_almacen:""}},methods:{async onSubmit(){if(this.nombre_almacen)try{await b.post("almacenes",{nombre_almacen:this.nombre_almacen}),S().fire({icon:"success",title:"Almac√©n creado con √©xito",text:"El nuevo almac√©n ha sido creado correctamente.",confirmButtonText:'<span style="color:white;">ok</span>'}),this.$router.push({name:"almacenes"}),console.log({nombre_almacen:this.nombre_almacen})}catch(e){console.error("Error al crear el almac√©n:",e.response.data),S().fire({icon:"error",title:"Error al crear el almacen",text:"Hubo un problema al crear el almac√©n. Por favor, int√©ntalo de nuevo.",confirmButtonText:'<span style="color:white;">ok</span>'})}else S().fire({icon:"warning",title:"Necesitas asignar un nombre al almac√©n",text:"Por favor, aseg√∫rate de llenar todos los campos requeridos.",confirmButtonText:'<span style="color:white;">ok</span>'})}}};const tr=(0,R.A)(or,[["render",rr],["__scopeId","data-v-122afea8"]]);var sr=tr;const nr=e=>((0,s.Qi)("data-v-75980183"),e=e(),(0,s.jt)(),e),lr=nr((()=>(0,s.Lk)("link",{rel:"stylesheet",href:"https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"},null,-1))),ir={class:"d-flex align-center mb-3"},cr=nr((()=>(0,s.Lk)("span",{class:"material-symbols-outlined"},"arrow_back",-1))),ur=nr((()=>(0,s.Lk)("h3",{class:"fw-bold mb-0"},"Crear nueva soluci√≥n stock",-1))),dr=["for"],mr={class:"row"},pr={key:0},br={class:"text-muted"},hr=nr((()=>(0,s.Lk)("span",null,"Quitar",-1)));function fr(e,a,r,o,n,l){return(0,s.uX)(),(0,s.CE)("form",{onSubmit:a[3]||(a[3]=(0,t.D$)(((...e)=>l.crearSolucion&&l.crearSolucion(...e)),["prevent"]))},[lr,(0,s.Lk)("div",ir,[(0,s.bF)(f.D,{icon:"",onClick:a[0]||(a[0]=a=>e.$router.push("/solucioness")),class:"mr-2"},{default:(0,s.k6)((()=>[cr])),_:1}),(0,s.bF)(v.B,{class:"encabezado",cols:"12",sm:"auto"},{default:(0,s.k6)((()=>[ur])),_:1})]),(0,s.bF)(C.J,null,{default:(0,s.k6)((()=>[(0,s.bF)(Ra.I,null,{default:(0,s.k6)((()=>[(0,s.bF)(k.L,null,{default:(0,s.k6)((()=>[(0,s.bF)(v.B,{cols:"12",sm:"6",md:"6"},{default:(0,s.k6)((()=>[(0,s.bF)(qa.W,{variant:"underlined",modelValue:n.nombre_solucion,"onUpdate:modelValue":a[1]||(a[1]=e=>n.nombre_solucion=e),label:"Nombre de la soluci√≥n","prepend-icon":"mdi-test-tube",required:""},null,8,["modelValue"])])),_:1}),(0,s.bF)(v.B,{cols:"12",sm:"6",md:"6"},{default:(0,s.k6)((()=>[(0,s.bF)(qa.W,{variant:"underlined",modelValue:n.medios_cultivo,"onUpdate:modelValue":a[2]||(a[2]=e=>n.medios_cultivo=e),label:"Medios de cultivo","prepend-icon":"mdi-flask-conical"},null,8,["modelValue"])])),_:1})])),_:1}),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.recursos,((e,a)=>((0,s.uX)(),(0,s.CE)("div",{key:a},[(0,s.Lk)("label",{for:"recurso-"+a,class:"form-label mb-2"},(0,w.v_)("Recurso "+(a+1)),9,dr),(0,s.Lk)("div",mr,[(0,s.bF)(v.B,{cols:"8",sm:"2",md:"5"},{default:(0,s.k6)((()=>[(0,s.bF)(Oa.d4,{id:"recurso-"+a,modelValue:e.recurso_id,"onUpdate:modelValue":[a=>e.recurso_id=a,e=>l.onChangeRecurso(a)],items:n.listaRecursos,"item-title":"nombre","item-value":"id",label:"Recurso","prepend-icon":"mdi-database",required:"",filterable:"",clearable:""},null,8,["id","modelValue","onUpdate:modelValue","items"])])),_:2},1024),(0,s.bF)(v.B,{cols:"8",sm:"2",md:"5"},{default:(0,s.k6)((()=>[(0,s.bF)(qa.W,{modelValue:e.cantidad_usada,"onUpdate:modelValue":a=>e.cantidad_usada=a,label:"Cantidad Usada",type:"number",step:"0.01","prepend-icon":"mdi-measurement-variant",required:"",onInput:e=>l.convertirEnTiempoReal(a)},null,8,["modelValue","onUpdate:modelValue","onInput"]),e.conversion?((0,s.uX)(),(0,s.CE)("div",pr,[(0,s.Lk)("small",br,(0,w.v_)(e.conversion),1)])):(0,s.Q3)("",!0)])),_:2},1024),(0,s.bF)(v.B,{cols:"8",sm:"2",md:"5"},{default:(0,s.k6)((()=>[(0,s.bF)(Oa.d4,{modelValue:e.unidad_medida,"onUpdate:modelValue":[a=>e.unidad_medida=a,e=>l.convertirEnTiempoReal(a)],items:l.obtenerUnidadesMedida(e.unidad_medida),label:"Unidad de Medida","prepend-icon":"mdi-scale",required:""},null,8,["modelValue","onUpdate:modelValue","items"])])),_:2},1024),(0,s.bF)(v.B,{cols:"8",sm:"2",md:"4"},{default:(0,s.k6)((()=>[(0,s.Lk)("div",null,[(0,s.bF)(f.D,{onClick:e=>l.eliminarRecurso(a),color:"error"},{default:(0,s.k6)((()=>[hr])),_:2},1032,["onClick"])])])),_:2},1024)])])))),128)),(0,s.bF)(k.L,{justify:"start",align:"center",class:"mt-3"},{default:(0,s.k6)((()=>[(0,s.bF)(v.B,{cols:"auto"},{default:(0,s.k6)((()=>[(0,s.bF)(f.D,{type:"button",color:"success",onClick:l.agregarRecurso},{default:(0,s.k6)((()=>[(0,s.eW)("Agregar Recurso")])),_:1},8,["onClick"])])),_:1})])),_:1}),(0,s.bF)(k.L,{justify:"start",align:"center",class:"mt-3"},{default:(0,s.k6)((()=>[(0,s.bF)(v.B,{cols:"auto"},{default:(0,s.k6)((()=>[(0,s.bF)(f.D,{type:"submit",color:"primary"},{default:(0,s.k6)((()=>[(0,s.eW)("Crear soluci√≥n stock")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})],32)}var vr={data(){return{nombre_solucion:"",medios_cultivo:"",recursos:[{recurso_id:null,cantidad_usada:"",unidad_medida:"",conversion:""}],listaRecursos:[]}},async mounted(){await this.cargarRecursos()},methods:{async cargarRecursos(){try{const e=await de.all();this.listaRecursos=e.map((e=>({id:e.id,nombre:`${e.nombre} - ${e.no_inventario} - ${e.unidad_medida}`,unidad_medida:e.unidad_medida})))}catch(e){console.error("Error al cargar los recursos:",e),S().fire({icon:"error",title:"Error al cargar recursos",text:"Hubo un problema al cargar los recursos. Por favor, int√©ntalo de nuevo.",confirmButtonText:'<span style="color:white;">OK</span>'})}},agregarRecurso(){this.recursos.push({recurso_id:null,cantidad_usada:"",unidad_medida:"",conversion:""})},eliminarRecurso(e){this.recursos.splice(e,1)},onChangeRecurso(e){const a=this.listaRecursos.find((a=>a.id===this.recursos[e].recurso_id));a&&(this.recursos[e].unidad_medida=a.unidad_medida,this.convertirEnTiempoReal(e))},obtenerUnidadesMedida(e){const a=["litros","mililitros","microlitros"],r=["kilogramos","gramos","miligramos","microgramos"];return a.includes(e)?a:r.includes(e)?r:[]},esUnidadDeVolumen(e){return["litros","mililitros","microlitros"].includes(e.toLowerCase())},esUnidadDeMasa(e){return["kilogramos","gramos","miligramos","microgramos"].includes(e.toLowerCase())},convertirUnidad(e,a,r){if(e=parseFloat(e),this.esUnidadDeVolumen(a))switch(a.toLowerCase()){case"litros":switch(r.toLowerCase()){case"litros":return e;case"mililitros":return 1e3*e;case"microlitros":return 1e6*e;default:return e}case"mililitros":switch(r.toLowerCase()){case"litros":return.001*e;case"mililitros":return e;case"microlitros":return 1e3*e;default:return e}case"microlitros":switch(r.toLowerCase()){case"litros":return 1e-6*e;case"mililitros":return.001*e;case"microlitros":return e;default:return e}}else if(this.esUnidadDeMasa(a))switch(a.toLowerCase()){case"gramos":switch(r.toLowerCase()){case"gramos":return e;case"miligramos":return 1e3*e;case"microgramos":return 1e6*e;case"kilogramos":return.001*e;default:return e}case"miligramos":switch(r.toLowerCase()){case"kilogramos":return 1e-6*e;case"gramos":return.001*e;case"miligramos":return e;case"microgramos":return 1e3*e;default:return e}case"microgramos":switch(r.toLowerCase()){case"kilogramos":return 1e-9*e;case"gramos":return 1e-6*e;case"miligramos":return.001*e;case"microgramos":return e;default:return e}case"kilogramos":switch(r.toLowerCase()){case"kilogramos":return e;case"gramos":return 1e3*e;case"miligramos":return 1e6*e;case"microgramos":return 1e9*e;default:return e}}return console.error(`Unidades no compatibles para conversi√≥n: ${a} -> ${r}`),e},convertirEnTiempoReal(e){const a=this.recursos[e];if(a.recurso_id&&a.cantidad_usada&&a.unidad_medida){const r=this.listaRecursos.find((e=>e.id===a.recurso_id)),o=r?.unidad_medida||a.unidad_medida;if(this.esUnidadDeVolumen(o)||this.esUnidadDeMasa(o)){const r=this.convertirUnidad(a.cantidad_usada,a.unidad_medida,o);this.recursos[e].conversion=`Conversi√≥n de ${a.unidad_medida} a ${o}: ${r} ${o}`}else this.recursos[e].conversion=""}else this.recursos[e].conversion=""},async crearSolucion(){try{const e=this.recursos.map((e=>{const a=parseFloat(e.cantidad_usada);let r;const o=this.listaRecursos.find((a=>a.id===e.recurso_id)),t=o?.unidad_medida||e.unidad_medida;return console.log(`Conversi√≥n para recurso ${o?.nombre}:`),console.log(`Cantidad original: ${a} ${e.unidad_medida}`),console.log(`Unidad base del recurso: ${t}`),this.esUnidadDeVolumen(t)||this.esUnidadDeMasa(t)?r=this.convertirUnidad(a,e.unidad_medida,t):(console.error(`Tipo de unidad no reconocido: ${t}`),r=a),console.log(`Cantidad convertida: ${r} ${t}`),{recurso_id:e.recurso_id,cantidad_usada:r,unidad_medida:t}})),a={nombre_solucion:this.nombre_solucion,medios_cultivo:this.medios_cultivo||null,recursos:e},r=await fetch("http://localhost:3000/api/v1/soluciones-stock",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!r.ok){const e=await r.json();throw console.error("Detalles del error:",e),new Error("Error al crear la soluci√≥n")}const o=await r.json();console.log("Respuesta del servidor:",o),S().fire({icon:"success",title:"Soluci√≥n creada con √©xito",confirmButtonText:'<span style="color:white;">OK</span>'})}catch(e){console.error("Error al crear la soluci√≥n:",e),S().fire({icon:"error",title:"Error",text:"Hubo un problema al crear la soluci√≥n. Por favor, int√©ntalo de nuevo.",confirmButtonText:'<span style="color:white;">OK</span>'})}},limpiarFormulario(){this.nombre_solucion="",this.medios_cultivo="",this.recursos=[{recurso_id:null,cantidad_usada:"",unidad_medida:"",conversion:""}]}}};const kr=(0,R.A)(vr,[["render",fr],["__scopeId","data-v-75980183"]]);var gr=kr,_r=r(594);const Lr=e=>((0,s.Qi)("data-v-0eb3ccbc"),e=e(),(0,s.jt)(),e),yr=Lr((()=>(0,s.Lk)("link",{rel:"stylesheet",href:"https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"},null,-1))),wr=Lr((()=>(0,s.Lk)("span",{class:"material-symbols-outlined"}," arrow_back ",-1))),Cr=Lr((()=>(0,s.Lk)("h3",{class:"fw-bold mb-3"},"Editar usuario",-1)));function Fr(e,a,r,o,n,l){return(0,s.uX)(),(0,s.Wv)($a.n,{onSubmit:(0,t.D$)(l.onSubmit,["prevent"])},{default:(0,s.k6)((()=>[yr,(0,s.Lk)("div",null,[(0,s.bF)(f.D,{icon:"",onClick:a[0]||(a[0]=a=>e.$router.push("/usuarios"))},{default:(0,s.k6)((()=>[wr])),_:1}),(0,s.bF)(v.B,{class:"encabezado",style:{margin:"-10px"},cols:"12"},{default:(0,s.k6)((()=>[Cr])),_:1})]),(0,s.bF)(C.J,null,{default:(0,s.k6)((()=>[(0,s.bF)(Ra.I,null,{default:(0,s.k6)((()=>[(0,s.bF)(k.L,null,{default:(0,s.k6)((()=>[(0,s.bF)(v.B,{cols:"12"},{default:(0,s.k6)((()=>[(0,s.bF)(qa.W,{modelValue:n.user.name,"onUpdate:modelValue":a[1]||(a[1]=e=>n.user.name=e),type:"text",label:"Usuario",variant:"underlined","prepend-icon":"mdi-account",required:""},null,8,["modelValue"])])),_:1}),(0,s.bF)(v.B,{cols:"12"},{default:(0,s.k6)((()=>[(0,s.bF)(_r.N,{modelValue:n.user.isAdmin,"onUpdate:modelValue":a[2]||(a[2]=e=>n.user.isAdmin=e),label:` ${n.user.isAdmin?"Administrador":"No es Administrador"} `,"off-value":"false","on-value":"true",color:"green"},null,8,["modelValue","label"])])),_:1}),(0,s.bF)(v.B,{cols:"12"},{default:(0,s.k6)((()=>[(0,s.bF)(f.D,{type:"submit",color:"primary"},{default:(0,s.k6)((()=>[(0,s.eW)("Actualizar")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["onSubmit"])}var xr={data(){return{user:{name:"",isAdmin:!1}}},async mounted(){const e=this.$route.params.id,a=(await b.get(`usuarios/${e}`)).data;this.user={...a,isAdmin:1===a.isAdmin}},methods:{async onSubmit(){try{const e=await b.patch(`usuarios/${this.$route.params.id}`,{name:this.user.name,isAdmin:this.user.isAdmin?1:0});console.log(e),this.$router.push({name:"usuarios"})}catch(e){console.error("Error al actualizar el usuario:",e)}}}};const Er=(0,R.A)(xr,[["render",Fr],["__scopeId","data-v-0eb3ccbc"]]);var Vr=Er;const Ar=e=>((0,s.Qi)("data-v-a608319e"),e=e(),(0,s.jt)(),e),Br=Ar((()=>(0,s.Lk)("link",{rel:"stylesheet",href:"https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"},null,-1))),Sr=Ar((()=>(0,s.Lk)("span",{class:"material-symbols-outlined"},"arrow_back",-1))),$r={class:"fw-bold mb-3"},Rr=Ar((()=>(0,s.Lk)("p",{class:"text-danger mt-1"},"Recuerda agregar nuevamente la fecha de caducidad para poder editar cualquier campo, de otra forma no ser√° posible actualizar nigun campo.",-1)));function qr(e,a,r,o,n,l){return(0,s.uX)(),(0,s.Wv)($a.n,{onSubmit:(0,t.D$)(l.onSubmit,["prevent"])},{default:(0,s.k6)((()=>[Br,(0,s.Lk)("div",null,[(0,s.bF)(f.D,{icon:"",onClick:a[0]||(a[0]=a=>e.$router.back())},{default:(0,s.k6)((()=>[Sr])),_:1}),(0,s.bF)(v.B,{class:"encabezado",style:{margin:"-10px"},cols:"12"},{default:(0,s.k6)((()=>[(0,s.Lk)("h3",$r,(0,w.v_)(n.formTitle),1)])),_:1})]),(0,s.bF)(C.J,null,{default:(0,s.k6)((()=>[(0,s.bF)(Ra.I,null,{default:(0,s.k6)((()=>[(0,s.bF)(k.L,null,{default:(0,s.k6)((()=>[(0,s.bF)(v.B,{cols:"12",sm:"6",md:"4"},{default:(0,s.k6)((()=>[(0,s.bF)(Oa.d4,{modelValue:n.recurso.catalogo_id,"onUpdate:modelValue":a[1]||(a[1]=e=>n.recurso.catalogo_id=e),items:n.catalogos,"item-title":"text","item-value":"value",label:"Almacen",variant:"underlined","prepend-icon":"mdi-storefront",required:"",onChange:l.cambiarCatalogo},null,8,["modelValue","items","onChange"])])),_:1}),(0,s.bF)(v.B,{cols:"12",sm:"6",md:"4"},{default:(0,s.k6)((()=>[(0,s.bF)(qa.W,{variant:"underlined",modelValue:n.recurso.no_inventario,"onUpdate:modelValue":a[2]||(a[2]=e=>n.recurso.no_inventario=e),label:"No. de inventario","prepend-icon":"mdi-format-list-numbered",required:""},null,8,["modelValue"])])),_:1}),(0,s.bF)(v.B,{cols:"12",sm:"6",md:"4"},{default:(0,s.k6)((()=>[(0,s.bF)(qa.W,{variant:"underlined",modelValue:n.recurso.nombre,"onUpdate:modelValue":a[3]||(a[3]=e=>n.recurso.nombre=e),label:"Nombre","prepend-icon":"mdi-label",required:""},null,8,["modelValue"])])),_:1}),(0,s.bF)(v.B,{cols:"12",sm:"6",md:"4"},{default:(0,s.k6)((()=>[(0,s.bF)(Oa.d4,{modelValue:n.recurso.tipo_recurso,"onUpdate:modelValue":a[4]||(a[4]=e=>n.recurso.tipo_recurso=e),items:["Reactivo","Soluci√≥n","Solvente"],label:"Tipo de recurso",variant:"underlined","prepend-icon":"mdi-sort",required:""},null,8,["modelValue"])])),_:1}),(0,s.bF)(v.B,{cols:"12",sm:"6",md:"4"},{default:(0,s.k6)((()=>[(0,s.bF)(qa.W,{variant:"underlined",modelValue:n.recurso.marca,"onUpdate:modelValue":a[5]||(a[5]=e=>n.recurso.marca=e),label:"Marca","prepend-icon":"mdi-tag",required:""},null,8,["modelValue"])])),_:1}),(0,s.bF)(v.B,{cols:"12",sm:"6",md:"4"},{default:(0,s.k6)((()=>[(0,s.bF)(qa.W,{modelValue:n.recurso.formula,"onUpdate:modelValue":a[6]||(a[6]=e=>n.recurso.formula=e),label:"F√≥rmula",variant:"underlined",rows:"3","prepend-icon":"mdi-molecule",required:""},null,8,["modelValue"])])),_:1}),(0,s.bF)(v.B,{cols:"12",sm:"6",md:"4"},{default:(0,s.k6)((()=>[(0,s.bF)(qa.W,{variant:"underlined",modelValue:n.recurso.pm,"onUpdate:modelValue":a[7]||(a[7]=e=>n.recurso.pm=e),label:"PM","prepend-icon":"mdi-wrench",required:""},null,8,["modelValue"])])),_:1}),(0,s.bF)(v.B,{cols:"12",sm:"6",md:"4"},{default:(0,s.k6)((()=>[(0,s.bF)(qa.W,{variant:"underlined",modelValue:n.recurso.capacidad_r,"onUpdate:modelValue":a[8]||(a[8]=e=>n.recurso.capacidad_r=e),label:"Cantidad disponible",type:"number","prepend-icon":"mdi-barrel",required:""},null,8,["modelValue"])])),_:1}),(0,s.bF)(v.B,{cols:"12",sm:"6",md:"4"},{default:(0,s.k6)((()=>[(0,s.bF)(qa.W,{variant:"underlined",modelValue:n.recurso.recipientes_actuales,"onUpdate:modelValue":a[9]||(a[9]=e=>n.recurso.recipientes_actuales=e),label:"Recipientes actuales",type:"number","prepend-icon":"mdi-cup",required:""},null,8,["modelValue"])])),_:1}),(0,s.bF)(v.B,{cols:"12",sm:"6",md:"4"},{default:(0,s.k6)((()=>[(0,s.bF)(qa.W,{variant:"underlined",modelValue:n.recurso.lote,"onUpdate:modelValue":a[10]||(a[10]=e=>n.recurso.lote=e),label:"Lote","prepend-icon":"mdi-barcode",required:""},null,8,["modelValue"])])),_:1}),(0,s.bF)(v.B,{cols:"12",sm:"6",md:"4"},{default:(0,s.k6)((()=>[(0,s.bF)(Oa.d4,{modelValue:n.recurso.unidad_medida,"onUpdate:modelValue":a[11]||(a[11]=e=>n.recurso.unidad_medida=e),items:["microlitros","mililitros","litros","microgramos","miligramos","gramos","kilogramos"],label:"Unidad de medida",variant:"underlined","prepend-icon":"mdi-ruler-square",required:""},null,8,["modelValue"])])),_:1}),(0,s.bF)(v.B,{cols:"12",sm:"6",md:"4"},{default:(0,s.k6)((()=>[(0,s.bF)(qa.W,{variant:"underlined",modelValue:n.recurso.fecha_caducidad,"onUpdate:modelValue":a[12]||(a[12]=e=>n.recurso.fecha_caducidad=e),label:"Fecha de caducidad",type:"date","prepend-icon":"mdi-calendar-range",required:""},null,8,["modelValue"])])),_:1})])),_:1}),Rr,(0,s.bF)(k.L,{justify:"start",align:"center",class:"mt-4"},{default:(0,s.k6)((()=>[(0,s.bF)(v.B,{cols:"auto"},{default:(0,s.k6)((()=>[(0,s.bF)(f.D,{type:"submit",color:"primary"},{default:(0,s.k6)((()=>[(0,s.eW)((0,w.v_)(n.submitText),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["onSubmit"])}var Ur={data(){return{recurso:{id:"",catalogo_id:"",no_inventario:"",nombre:"",tipo_recurso:"",marca:"",pm:"",formula:"",capacidad_r:"",lote:"",recipientes_actuales:"",unidad_medida:"",fecha_caducidad:null},catalogos:[],formTitle:"Editar Recurso",submitText:"Actualizar"}},computed:{mostrarAdvertencia(){return!this.recurso.fecha_caducidad}},async mounted(){await this.cargarCatalogos(),await this.cargarRecurso()},methods:{async cargarCatalogos(){try{const e=await ue.all();this.catalogos=e.map((e=>({value:e.id,text:`${e.id} - ${e.nombre_almacen}`})))}catch(e){console.error("Error al cargar los almacenes:",e),S().fire({icon:"error",title:"Error al cargar almacenes",text:"Hubo un problema al cargar los almacenes. Por favor, int√©ntelo de nuevo.",confirmButtonText:'<span style="color:white;">OK</span>'})}},async cargarRecurso(){try{const e=(await b.get(`recursos/${this.$route.params.id}`)).data;this.recurso={...e,unidad_medida:e.unidad_medida||"",fecha_caducidad:new Date(e.fecha_caducidad)}}catch(e){console.error("Error al cargar el recurso:",e),S().fire({icon:"error",title:"Error al cargar el recurso",text:"Hubo un problema al cargar el recurso. Por favor, int√©ntelo de nuevo.",confirmButtonText:'<span style="color:white;">OK</span>'})}},async onSubmit(){try{if(await this.verificarFechaCaducidad(),this.recurso.id){const e=await b.patch(`recursos/${this.$route.params.id}`,this.recurso);console.log(e),S().fire({icon:"success",title:"Recurso actualizado con √©xito",text:"El recurso ha sido actualizado exitosamente.",confirmButtonText:'<span style="color:white;">OK</span>'}),this.$router.push({name:"recursos"})}else{const e=await b.post("recursos",this.recurso);this.$router.push({name:"recursos",params:{id:e.data.id}})}}catch(e){console.error("Error al guardar/recuperar el recurso:",e),S().fire({icon:"error",title:"Error al guardar/recuperar el recurso",text:"Se recomienda verificar si se ingres√≥ fecha.",confirmButtonText:'<span style="color:white;">OK</span>'})}},verificarFechaCaducidad(){this.recurso.fecha_caducidad||S().fire({icon:"error",title:"Error",text:"Recuerda agregar nuevamente la fecha de caducidad para poder editar cualquier campo.",confirmButtonText:'<span style="color:white;">OK</span>'})},cambiarCatalogo(){this.recurso.catalogo_id=this.catalogos.find((e=>e.value===this.recurso.catalogo_id))?.text||""}}};const Ir=(0,R.A)(Ur,[["render",qr],["__scopeId","data-v-a608319e"]]);var Pr=Ir;const Tr=e=>((0,s.Qi)("data-v-761f25aa"),e=e(),(0,s.jt)(),e),Dr=Tr((()=>(0,s.Lk)("link",{rel:"stylesheet",href:"https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"},null,-1))),Xr=Tr((()=>(0,s.Lk)("span",{class:"material-symbols-outlined"},"arrow_back",-1))),Mr=Tr((()=>(0,s.Lk)("h3",{class:"fw-bold mb-3"},"Editar almac√©n",-1)));function Wr(e,a,r,o,n,l){return(0,s.uX)(),(0,s.Wv)($a.n,{onSubmit:(0,t.D$)(l.onSubmit,["prevent"])},{default:(0,s.k6)((()=>[Dr,(0,s.Lk)("div",null,[(0,s.bF)(f.D,{icon:"",onClick:a[0]||(a[0]=a=>e.$router.go(-1))},{default:(0,s.k6)((()=>[Xr])),_:1}),(0,s.bF)(v.B,{class:"encabezado",style:{margin:"-10px"},cols:"12"},{default:(0,s.k6)((()=>[Mr])),_:1})]),(0,s.bF)(C.J,null,{default:(0,s.k6)((()=>[(0,s.bF)(Ra.I,null,{default:(0,s.k6)((()=>[(0,s.bF)(k.L,null,{default:(0,s.k6)((()=>[(0,s.bF)(v.B,{cols:"12"},{default:(0,s.k6)((()=>[(0,s.bF)(qa.W,{modelValue:n.almacen.nombre_almacen,"onUpdate:modelValue":a[1]||(a[1]=e=>n.almacen.nombre_almacen=e),type:"text",label:"Nombre del almac√©n",variant:"underlined","prepend-icon":"mdi-account",required:""},null,8,["modelValue"])])),_:1}),(0,s.bF)(v.B,{cols:"12"},{default:(0,s.k6)((()=>[(0,s.bF)(f.D,{type:"button",color:"primary",onClick:l.onSubmit},{default:(0,s.k6)((()=>[(0,s.eW)("Actualizar")])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["onSubmit"])}var Or={data(){return{almacen:{nombre_almacen:""}}},async mounted(){const e=this.$route.params.id;console.log("ID del almac√©n:",e);try{const a=await b.get(`almacenes/${e}`);console.log("Datos del almac√©n:",a.data),this.almacen={...a.data,nombre_almacen:a.nombre_almacen}}catch(a){console.error("Error al cargar los datos del almac√©n:",a)}},methods:{async onSubmit(){try{const e=await b.patch(`almacenes/${this.$route.params.id}`,{nombre_almacen:this.almacen.nombre_almacen});console.log("Respuesta de actualizaci√≥n:",e),this.$router.push({name:"almacenes"}),S().fire({icon:"success",title:"Almac√©n creado con √©xito",text:"El nuevo almac√©n ha sido creado correctamente.",confirmButtonText:'<span style="color:white;">ok</span>'})}catch(e){console.error("Error al actualizar el almacen:",e)}}}};const zr=(0,R.A)(Or,[["render",Wr],["__scopeId","data-v-761f25aa"]]);var jr=zr;const Nr=e=>((0,s.Qi)("data-v-281a77e6"),e=e(),(0,s.jt)(),e),Qr={class:"container-fluid"},Kr={class:"d-flex align-center mb-3"},Jr=Nr((()=>(0,s.Lk)("span",{class:"material-symbols-outlined"},"‚¨Ö",-1))),Gr=Nr((()=>(0,s.Lk)("h3",{class:"fw-bold mb-0 text-color",style:{color:"#0c934a"}}," Editar Soluci√≥n ",-1))),Hr={class:"mb-3"},Yr=Nr((()=>(0,s.Lk)("label",{for:"medios_cultivo",class:"form-label"},"Medio de Cultivo",-1))),Zr={class:"mb-3"},eo=Nr((()=>(0,s.Lk)("label",{for:"nombre_solucion",class:"form-label"},"Nombre de la Soluci√≥n",-1))),ao={class:"mb-3"},ro=Nr((()=>(0,s.Lk)("h5",null,"Recursos Asociados",-1))),oo={class:"row"},to={class:"col-md-4"},so=["for"],no=["id","onUpdate:modelValue","onChange"],lo=["value"],io={class:"col-md-3"},co=["for"],uo=["id","onUpdate:modelValue","onInput"],mo={key:0,class:"mt-2"},po={class:"text-muted"},bo={class:"col-md-3"},ho=["for"],fo=["id","onUpdate:modelValue","onChange"],vo=["value"],ko={class:"col-md-2 d-flex align-items-end"},go=["onClick"],_o={class:"mt-3"},Lo={class:"mt-4"},yo=Nr((()=>(0,s.Lk)("button",{type:"submit",class:"btn btn-primary"},"Guardar Cambios",-1)));function wo(e,a,r,o,n,l){return(0,s.uX)(),(0,s.CE)("div",Qr,[(0,s.Lk)("div",Kr,[(0,s.bF)(f.D,{icon:"",onClick:a[0]||(a[0]=a=>e.$router.push("/solucioness")),class:"mr-2"},{default:(0,s.k6)((()=>[Jr])),_:1}),Gr]),(0,s.Lk)("form",{onSubmit:a[5]||(a[5]=(0,t.D$)(((...e)=>o.guardarCambios&&o.guardarCambios(...e)),["prevent"]))},[(0,s.Lk)("div",Hr,[Yr,(0,s.bo)((0,s.Lk)("input",{type:"text",class:"form-control",id:"medios_cultivo","onUpdate:modelValue":a[1]||(a[1]=e=>o.solucion.medios_cultivo=e)},null,512),[[t.Jo,o.solucion.medios_cultivo]])]),(0,s.Lk)("div",Zr,[eo,(0,s.bo)((0,s.Lk)("input",{type:"text",class:"form-control",id:"nombre_solucion","onUpdate:modelValue":a[2]||(a[2]=e=>o.solucion.nombre_solucion=e)},null,512),[[t.Jo,o.solucion.nombre_solucion]])]),(0,s.Lk)("div",ao,[ro,((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(o.solucion.recursos,((e,a)=>((0,s.uX)(),(0,s.CE)("div",{key:a,class:"mb-4"},[(0,s.Lk)("div",oo,[(0,s.Lk)("div",to,[(0,s.Lk)("label",{for:"recurso-"+a,class:"form-label"},"Recurso",8,so),(0,s.bo)((0,s.Lk)("select",{id:"recurso-"+a,class:"form-select","onUpdate:modelValue":a=>e.recurso_id=a,onChange:e=>o.onChangeRecurso(a)},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(o.listaRecursos,(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.id,value:e.id},(0,w.v_)(e.nombre),9,lo)))),128))],40,no),[[t.u1,e.recurso_id]])]),(0,s.Lk)("div",io,[(0,s.Lk)("label",{for:"cantidad-"+a,class:"form-label"},"Cantidad Usada",8,co),(0,s.bo)((0,s.Lk)("input",{id:"cantidad-"+a,type:"number",class:"form-control","onUpdate:modelValue":a=>e.cantidad_usada=a,step:"0.00000000000001",onInput:e=>o.convertirEnTiempoReal(a)},null,40,uo),[[t.Jo,e.cantidad_usada]]),e.conversion?((0,s.uX)(),(0,s.CE)("div",mo,[(0,s.Lk)("small",po,(0,w.v_)(e.conversion),1)])):(0,s.Q3)("",!0)]),(0,s.Lk)("div",bo,[(0,s.Lk)("label",{for:"unidad-"+a,class:"form-label"},"Unidad de Medida",8,ho),(0,s.bo)((0,s.Lk)("select",{id:"unidad-"+a,class:"form-select","onUpdate:modelValue":a=>e.unidad_medida=a,onChange:e=>o.convertirEnTiempoReal(a)},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(o.obtenerUnidadesMedida(e.unidad_medida),(e=>((0,s.uX)(),(0,s.CE)("option",{key:e,value:e},(0,w.v_)(e),9,vo)))),128))],40,fo),[[t.u1,e.unidad_medida]])]),(0,s.Lk)("div",ko,[(0,s.Lk)("button",{type:"button",class:"btn btn-danger",onClick:e=>o.eliminarRecurso(a)}," Eliminar ",8,go)])])])))),128)),(0,s.Lk)("div",_o,[(0,s.Lk)("button",{type:"button",class:"btn btn-success",onClick:a[3]||(a[3]=(...e)=>o.agregarRecurso&&o.agregarRecurso(...e))}," Agregar Recurso ")])]),(0,s.Lk)("div",Lo,[yo,(0,s.Lk)("button",{type:"button",class:"btn btn-secondary ms-2",onClick:a[4]||(a[4]=(...e)=>o.cancelarEdicion&&o.cancelarEdicion(...e))}," Cancelar ")])],32)])}var Co={setup(){const e=(0,c.lq)(),a=(0,c.rd)(),r=(0,Ca.KR)({medios_cultivo:"",nombre_solucion:"",recursos:[]}),o=(0,Ca.KR)([]),t=()=>{a.go(-1)},n=async()=>{try{const a=e.params.id,t=await Fa.getWithResources(a);r.value=t,r.value.recursos.forEach(((e,a)=>{if(e.recurso_id){const r=o.value.find((a=>a.id===e.recurso_id));r&&(e.unidad_medida=r.unidad_medida,p(a))}}))}catch(a){console.error("Error cargando la soluci√≥n:",a),S().fire({icon:"error",title:"Error",text:"Error al cargar la soluci√≥n. Por favor, int√©ntalo de nuevo."})}},l=async()=>{try{const e=await de.all();o.value=e.map((e=>({id:e.id,nombre:`${e.nombre} - ${e.no_inventario} - ${e.unidad_medida}`,unidad_medida:e.unidad_medida})))}catch(e){console.error("Error cargando los recursos:",e),S().fire({icon:"error",title:"Error",text:"Error al cargar los recursos. Por favor, int√©ntalo de nuevo."})}},i=()=>{r.value.recursos.push({recurso_id:null,cantidad_usada:"",unidad_medida:"",conversion:""})},u=e=>{r.value.recursos.splice(e,1)},d=e=>{const a=o.value.find((a=>a.id===r.value.recursos[e].recurso_id));a&&(r.value.recursos[e].unidad_medida=a.unidad_medida,p(e))},m=e=>{const a=["litros","mililitros","microlitros"],r=["kilogramos","gramos","miligramos","microgramos"];return a.includes(e)?a:r.includes(e)?r:[]},p=e=>{const a=r.value.recursos[e];if(a.recurso_id&&a.cantidad_usada&&a.unidad_medida){const e=o.value.find((e=>e.id===a.recurso_id)),r=e?.unidad_medida||a.unidad_medida;if(b(r)||h(r)){const e=f(a.cantidad_usada,a.unidad_medida,r);a.conversion=`Conversi√≥n de ${a.unidad_medida} a ${r}: ${e} ${r}`}else a.conversion=""}else a.conversion=""},b=e=>["litros","mililitros","microlitros"].includes(e.toLowerCase()),h=e=>["kilogramos","gramos","miligramos","microgramos"].includes(e.toLowerCase()),f=(e,a,r)=>{if(e=parseFloat(e),b(a))switch(a.toLowerCase()){case"litros":switch(r.toLowerCase()){case"litros":return e;case"mililitros":return 1e3*e;case"microlitros":return 1e6*e;default:return e}case"mililitros":switch(r.toLowerCase()){case"litros":return.001*e;case"mililitros":return e;case"microlitros":return 1e3*e;default:return e}case"microlitros":switch(r.toLowerCase()){case"litros":return 1e-6*e;case"mililitros":return.001*e;case"microlitros":return e;default:return e}}else if(h(a))switch(a.toLowerCase()){case"gramos":switch(r.toLowerCase()){case"gramos":return e;case"miligramos":return 1e3*e;case"microgramos":return 1e6*e;case"kilogramos":return.001*e;default:return e}case"miligramos":switch(r.toLowerCase()){case"kilogramos":return 1e-6*e;case"gramos":return.001*e;case"miligramos":return e;case"microgramos":return 1e3*e;default:return e}case"microgramos":switch(r.toLowerCase()){case"kilogramos":return 1e-9*e;case"gramos":return 1e-6*e;case"miligramos":return.001*e;case"microgramos":return e;default:return e}case"kilogramos":switch(r.toLowerCase()){case"kilogramos":return e;case"gramos":return 1e3*e;case"miligramos":return 1e6*e;case"microgramos":return 1e9*e;default:return e}}return console.error(`Unidades no compatibles para conversi√≥n: ${a} -> ${r}`),e},v=async()=>{try{const t=e.params.id,s={medios_cultivo:r.value.medios_cultivo,nombre_solucion:r.value.nombre_solucion,recursos:r.value.recursos.map((e=>{const a=o.value.find((a=>a.id===e.recurso_id)),r=a?.unidad_medida||e.unidad_medida,t=f(e.cantidad_usada,e.unidad_medida,r);return{recurso_id:e.recurso_id,cantidad_usada:t,unidad_medida:r}}))};await Fa.update(t,s),await S().fire({icon:"success",title:"¬°√âxito!",text:"La soluci√≥n se ha actualizado correctamente.",confirmButtonText:"Aceptar"}),a.push({name:"solucioness"})}catch(t){console.error("Error actualizando la soluci√≥n:",t),S().fire({icon:"error",title:"Error",text:"Hubo un problema al actualizar la soluci√≥n. Por favor, int√©ntalo de nuevo."})}},k=()=>{a.push({name:"solucioness"})};return(0,s.sV)((async()=>{await l(),await n()})),{solucion:r,listaRecursos:o,regresar:t,agregarRecurso:i,eliminarRecurso:u,onChangeRecurso:d,obtenerUnidadesMedida:m,convertirEnTiempoReal:p,guardarCambios:v,cancelarEdicion:k}}};const Fo=(0,R.A)(Co,[["render",wo],["__scopeId","data-v-281a77e6"]]);var xo=Fo;const Eo={class:"container-fluid p-0"},Vo=(0,s.Fv)('<div class="row justify-content-center align-items-center mb-4" data-v-77ba81c0><div class="col-auto" data-v-77ba81c0><h3 class="fw-bold mb-0 text-color" style="color:#0c934a;" data-v-77ba81c0>Inicio</h3></div></div><div class="row justify-content-center" data-v-77ba81c0><div class="col-md-6 mb-4" data-v-77ba81c0><div class="card shadow-none bg-light rounded" data-v-77ba81c0><div class="card-header" data-v-77ba81c0><h5 class="mb-0" data-v-77ba81c0>Gr√°fica de Almacenes</h5></div><div class="card-body" data-v-77ba81c0><canvas id="almacenChart" data-v-77ba81c0></canvas></div></div></div><div class="col-md-4 mb-4" data-v-77ba81c0><div class="card shadow-none bg-light rounded" data-v-77ba81c0><div class="card-header" data-v-77ba81c0><h5 class="mb-0" data-v-77ba81c0>Distribuci√≥n de Tipos de Recursos</h5></div><div class="card-body" data-v-77ba81c0><canvas id="tipoRecursoChart" data-v-77ba81c0></canvas></div></div></div></div>',2),Ao=[Vo];function Bo(e,a,r,o,t,n){return(0,s.uX)(),(0,s.CE)("div",Eo,Ao)}var So=r(8874),$o=r.n(So),Ro=r(6782),qo={name:"DashboardView",data(){return{almacenes:[],recursos:[]}},async mounted(){$o().load({google:{families:["Public Sans:300,400,500,600,700"]},custom:{families:["Font Awesome 5 Solid","Font Awesome 5 Regular","Font Awesome 5 Brands","simple-line-icons"],urls:["assets/css/fonts.min.css"]},active:function(){sessionStorage.fonts=!0}}),await this.cargarDatos(),this.generarGraficaAlmacenes(),this.generarGraficaTiposRecursos()},methods:{navigateToUsers(){this.$router.push("/usuarios")},async cargarDatos(){try{this.almacenes=await ue.all(),this.recursos=await de.all()}catch(e){console.error("Error al cargar datos:",e)}},generarGraficaAlmacenes(){const e=document.getElementById("almacenChart").getContext("2d"),a=this.almacenes.map((e=>({nombre:e.nombre_almacen,cantidad:this.recursos.filter((a=>a.catalogo_id===e.id)).length})));new Ro.Ay(e,{type:"bar",data:{labels:a.map((e=>e.nombre)),datasets:[{label:"Cantidad de Recursos",data:a.map((e=>e.cantidad)),backgroundColor:"rgba(54, 162, 235, 0.9)",borderColor:"rgba(54, 162, 235, 1)",borderWidth:1}]},options:{responsive:!0,scales:{y:{beginAtZero:!0}}}})},generarGraficaTiposRecursos(){const e=document.getElementById("tipoRecursoChart").getContext("2d"),a=this.recursos.reduce(((e,a)=>(e[a.tipo_recurso]=(e[a.tipo_recurso]||0)+1,e)),{});new Ro.Ay(e,{type:"pie",data:{labels:Object.keys(a),datasets:[{label:"Distribuci√≥n de Tipos de Recursos",data:Object.values(a),backgroundColor:["rgba(255, 99, 132, 0.9)","rgba(54, 162, 235, 0.9)","rgba(255, 206, 86, 0.9)","rgba(75, 192, 192, 0.9)","rgba(153, 102, 255, 0.9)","rgba(255, 159, 64, 0.9)"],borderColor:["rgba(255, 99, 132, 1.5)","rgba(54, 162, 235, 1.5)","rgba(255, 206, 86, 1.5)","rgba(75, 192, 192, 1.5)","rgba(153, 102, 255, 1.5)","rgba(255, 159, 64, 1.5)"],borderWidth:1}]},options:{responsive:!0}})}}};const Uo=(0,R.A)(qo,[["render",Bo],["__scopeId","data-v-77ba81c0"]]);var Io=Uo;const Po=e=>((0,s.Qi)("data-v-2f7ed02a"),e=e(),(0,s.jt)(),e),To={class:"container-fluid"},Do={class:"row"},Xo=(0,s.Fv)('<section class="col-md-6" id="panel-left" data-v-2f7ed02a><div class="col-12 logo-container d-flex flex-column justify-content-center align-items-center" data-v-2f7ed02a><h1 class="w-bold text-center" data-v-2f7ed02a>SIGIRES INIFAP</h1><p class="col-12 text-center description mb-3" data-v-2f7ed02a> Bienvenido, al sistema de gesti√≥n <br data-v-2f7ed02a> de inventarios de reactivos y soluciones. </p><img src="/imagenes/entrada.jpg" alt="" style="width:500px;height:auto;border-radius:4px;background-color:rgba(255, 255, 255, 0.7);" data-v-2f7ed02a></div></section>',1),Mo={class:"col-md-6",id:"panel-right"},Wo={class:"container justify-content-center align-items-center col-12"},Oo=(0,s.Fv)('<div class="col-12 text-center justify-content-center aling-items-center" data-v-2f7ed02a><svg xmlns="http://www.w3.org/2000/svg" width="65" height="65" fill="#0c934a" class="bi bi-door-open" viewBox="0 0 16 16" data-v-2f7ed02a><path d="M8.5 10c-.276 0-.5-.448-.5-1s.224-1 .5-1 .5.448.5 1-.224 1-.5 1" data-v-2f7ed02a></path><path d="M10.828.122A.5.5 0 0 1 11 .5V1h.5A1.5 1.5 0 0 1 13 2.5V15h1.5a.5.5 0 0 1 0 1h-13a.5.5 0 0 1 0-1H3V1.5a.5.5 0 0 1 .43-.495l7-1a.5.5 0 0 1 .398.117M11.5 2H11v13h1V2.5a.5.5 0 0 0-.5-.5M4 1.934V15h6V1.077z" data-v-2f7ed02a></path></svg></div><div class="row mb-5" data-v-2f7ed02a><h2 class="col-12 text-center" data-v-2f7ed02a>Iniciar sesi√≥n</h2></div>',2),zo={class:"row"},jo={class:"form-group"},No=Po((()=>(0,s.Lk)("br",null,null,-1))),Qo={class:"form-group"},Ko={class:"form-group text-center pt-4"},Jo={class:"row mt-5"},Go={key:0,class:"error-message-container"};function Ho(e,a,r,o,n,l){const i=(0,s.gN)("btn");return(0,s.uX)(),(0,s.CE)("body",To,[(0,s.Lk)("main",Do,[Xo,(0,s.Lk)("section",Mo,[(0,s.Lk)("div",Wo,[Oo,(0,s.Lk)("div",zo,[(0,s.Lk)("form",{onSubmit:a[3]||(a[3]=(0,t.D$)(((...e)=>l.handleFormSubmit&&l.handleFormSubmit(...e)),["prevent"])),class:"col-12 col-md-8 offset-md-2"},[(0,s.Lk)("div",jo,[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>n.name=e),class:"form-control",name:"email",id:"email",placeholder:"Usuario",required:""},null,512),[[t.Jo,n.name]])]),No,(0,s.Lk)("div",Qo,[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":a[1]||(a[1]=e=>n.password=e),type:"password",class:"form-control",name:"password",id:"password",placeholder:"Contrase√±a",required:""},null,512),[[t.Jo,n.password]])]),(0,s.Lk)("div",Ko,[(0,s.bo)((0,s.Lk)("input",{onClick:a[2]||(a[2]=e=>l.onLogin()),type:"submit",class:"btn btn-primary",value:"Ingresar"},null,512),[[i]])])],32)]),(0,s.Lk)("div",Jo,[n.errorMessage?((0,s.uX)(),(0,s.CE)("div",Go,(0,w.v_)(n.errorMessage),1)):(0,s.Q3)("",!0)])])])])])}class Yo{static async login(e,a){const r=await b.post("login",{name:e,password:a}),o=r.data.data.token,t=r.data.data.isAdmin;return u.set(o),localStorage.setItem("username",e),localStorage.setItem("isAdmin",t?"true":"false"),r.data.data}}var Zo={data(){return{name:"",password:"",errorMessage:""}},setup(){const e=(0,c.rd)();return{router:e}},methods:{handleFormSubmit(e){e.preventDefault(),this.onLogin()},async onLogin(){try{const e=await Yo.login(this.name,this.password);if(!e.token)throw new Error("Credenciales incorrectas");this.router.push({name:"dashboard"})}catch(e){this.errorMessage="Error, ingresaste el usuario o contrase√±a incorrecta, por favor ingresa datos v√°lidos"}}}};const et=(0,R.A)(Zo,[["render",Ho],["__scopeId","data-v-2f7ed02a"]]);var at=et;const rt=(0,s.Lk)("h1",null,"Error 403",-1);function ot(e,a,r,o,t,n){return(0,s.uX)(),(0,s.CE)("div",null,[rt,(0,s.bF)(f.D,{color:"primary",onClick:n.redirectToLogin},{default:(0,s.k6)((()=>[(0,s.eW)("Necesitas iniciar sesi√≥n")])),_:1},8,["onClick"])])}var tt={methods:{redirectToLogin(){this.$router.push("/login")}}};const st=(0,R.A)(tt,[["render",ot]]);var nt=st,lt=r.p+"img/undraw_access-denied_krem.15a1a2cc.svg",it=r(5126);const ct=e=>((0,s.Qi)("data-v-3e27850e"),e=e(),(0,s.jt)(),e),ut=ct((()=>(0,s.Lk)("h1",{class:"display-2 font-weight-bold mb-4"},"Error 403",-1))),dt=ct((()=>(0,s.Lk)("h2",{class:"headline"},"Acceso Denegado",-1))),mt=ct((()=>(0,s.Lk)("p",{class:"subtitle-1 mt-3"}," Lo sentimos, no tienes permisos para acceder a esta p√°gina. ",-1)));function pt(e,a,r,o,t,n){return(0,s.uX)(),(0,s.Wv)(Ra.I,{class:"fill-height",fluid:""},{default:(0,s.k6)((()=>[(0,s.bF)(k.L,{align:"center",justify:"center"},{default:(0,s.k6)((()=>[(0,s.bF)(v.B,{cols:"12",md:"6",class:"text-center"},{default:(0,s.k6)((()=>[(0,s.bF)(k.L,{align:"center",justify:"center"},{default:(0,s.k6)((()=>[(0,s.bF)(it.y,{src:lt,alt:"Error 403",class:"mb-4","max-width":"300"})])),_:1}),ut,dt,mt,(0,s.bF)(f.D,{color:"primary",large:"",onClick:n.redirectToLogin,class:"mt-5"},{default:(0,s.k6)((()=>[(0,s.eW)(" Volver al Inicio ")])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1})}var bt={methods:{redirectToLogin(){this.$router.push("/dashboard")}}};const ht=(0,R.A)(bt,[["render",pt],["__scopeId","data-v-3e27850e"]]);var ft=ht;const vt=e=>((0,s.Qi)("data-v-05e2d27c"),e=e(),(0,s.jt)(),e),kt=vt((()=>(0,s.Lk)("link",{href:"https://fonts.googleapis.com/css?family=Material+Icons",rel:"stylesheet"},null,-1))),gt=vt((()=>(0,s.Lk)("link",{rel:"stylesheet",href:"https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0&icon_names=bar_chart"},null,-1))),_t=vt((()=>(0,s.Lk)("span",{class:"material-icons"},"keyboard_double_arrow_right",-1))),Lt=[_t],yt=vt((()=>(0,s.Lk)("h3",null,"Men√∫",-1))),wt={class:"menu"},Ct=vt((()=>(0,s.Lk)("span",{class:"material-icons"},"home",-1))),Ft=vt((()=>(0,s.Lk)("span",{class:"text"},"Inicio",-1))),xt=vt((()=>(0,s.Lk)("span",{class:"material-icons"},"science",-1))),Et=vt((()=>(0,s.Lk)("span",{class:"text"},"Recursos",-1))),Vt=vt((()=>(0,s.Lk)("span",{class:"material-icons"},"warehouse",-1))),At=vt((()=>(0,s.Lk)("span",{class:"text"},"Almacenes",-1))),Bt=vt((()=>(0,s.Lk)("span",{class:"material-icons"},"inventory_2",-1))),St=vt((()=>(0,s.Lk)("span",{class:"text"},"Soluciones stock",-1))),$t=vt((()=>(0,s.Lk)("span",{class:"material-icons"},"fact_check",-1))),Rt=vt((()=>(0,s.Lk)("span",{class:"text"},"Inventario",-1))),qt=vt((()=>(0,s.Lk)("span",{class:"material-icons"},"group",-1))),Ut=vt((()=>(0,s.Lk)("span",{class:"text"},"Usuarios",-1)));var It={__name:"AppSidebar",setup(e){const a=(0,Ca.KR)("true"===localStorage.getItem("is_expanded")),r=(0,Ca.KR)("true"===localStorage.getItem("isAdmin")),o=()=>{a.value=!a.value,localStorage.setItem("is_expanded",a.value)};return(e,t)=>{const n=(0,s.g2)("router-link");return(0,s.uX)(),(0,s.CE)("aside",{class:(0,w.C4)(""+(a.value?"is-expanded":""))},[kt,gt,(0,s.Lk)("div",{class:"menu-toggle-wrap"},[(0,s.Lk)("button",{class:"menu-toggle",onClick:o},Lt)]),yt,(0,s.Lk)("div",wt,[(0,s.bF)(n,{class:"button",to:"/dashboard"},{default:(0,s.k6)((()=>[Ct,Ft])),_:1}),(0,s.bF)(n,{class:"button",to:"/recursos"},{default:(0,s.k6)((()=>[xt,Et])),_:1}),(0,s.bF)(n,{class:"button",to:"/almacenes"},{default:(0,s.k6)((()=>[Vt,At])),_:1}),(0,s.bF)(n,{class:"button",to:"/solucioness"},{default:(0,s.k6)((()=>[Bt,St])),_:1}),(0,s.bF)(n,{class:"button",to:"/inventario"},{default:(0,s.k6)((()=>[$t,Rt])),_:1}),r.value?((0,s.uX)(),(0,s.Wv)(n,{key:0,class:"button",to:"/usuarios"},{default:(0,s.k6)((()=>[qt,Ut])),_:1})):(0,s.Q3)("",!0)])],2)}}};const Pt=(0,R.A)(It,[["__scopeId","data-v-05e2d27c"]]);var Tt=Pt;const Dt=e=>((0,s.Qi)("data-v-468a0562"),e=e(),(0,s.jt)(),e),Xt={class:"navbar mb-0",style:{display:"flex","align-items":"center"}},Mt=Dt((()=>(0,s.Lk)("div",{style:{flex:"1"}},[(0,s.Lk)("h5",{class:"text-nav",style:{transform:"translateX(10px) translateY(5px)"}}," SIGIRES-INIFAP ")],-1))),Wt={class:"username",style:{"margin-right":"20px","margin-left":"20px",transform:"translateX(-30px)"}},Ot={key:0,style:{"list-style":"none",background:"white",position:"absolute",top:"100%","z-index":"2","min-width":"300px",left:"100%",transform:"translateX(-300px) translateY(8px)","box-shadow":"rgba(0, 0, 0, 0.35) 0px 5px 15px","border-radius":"16px"}};function zt(e,a,r,o,t,n){return(0,s.uX)(),(0,s.CE)("div",null,[(0,s.Lk)("nav",Xt,[Mt,(0,s.Lk)("div",Wt,[(0,s.Lk)("span",null,(0,w.v_)(t.username),1)]),(0,s.Lk)("div",{onClick:a[1]||(a[1]=(...e)=>n.toggleMenu&&n.toggleMenu(...e)),class:"nav-edit",style:{"background-image":"url(/imagenes/admin.png)","background-size":"contain",cursor:"pointer","border-radius":"50%",width:"30px",height:"30px",position:"relative",transform:"translateX(-30px) translateY(0px)"}},[t.isActive?((0,s.uX)(),(0,s.CE)("ul",Ot,[(0,s.Lk)("li",{onClick:a[0]||(a[0]=(...e)=>n.onLogout&&n.onLogout(...e)),style:{padding:"10px 20px"}},"Cerrar sesi√≥n")])):(0,s.Q3)("",!0)])])])}var jt={data(){return{isActive:!1,isBarVisible:!0,username:localStorage.getItem("username")||""}},methods:{handleMouseEnter(e){const a=this.$refs.iconContainer.getBoundingClientRect(),r=a.left+a.width/2,o=a.top+a.height/2,t=e.clientX-r,s=e.clientY-o,n=Math.sqrt(t*t+s*s);n<=10&&(this.isMenuActive=!0)},handleMouseLeave(){this.isMenuActive=!1},toggleMenu(){this.isActive=!this.isActive},toggleBarVisibility(){this.isBarVisible=!this.isBarVisible},async onLogout(){const e=await S().fire({title:"¬øEst√°s seguro de cerrar sesi√≥n?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:'<span style="color:white;">S√≠, cerrar sesi√≥n</span>',cancelButtonText:'<span style="color:white;">No</span>'});e.isConfirmed&&(u.clear(),localStorage.removeItem("username"),this.$router.push({name:"login"}))}}};const Nt=(0,R.A)(jt,[["render",zt],["__scopeId","data-v-468a0562"]]);var Qt=Nt;const Kt={class:"app"},Jt={class:"content"},Gt={class:"main"};var Ht={__name:"AuthLayout",setup(e){return(e,a)=>{const r=(0,s.g2)("router-view");return(0,s.uX)(),(0,s.CE)("div",Kt,[(0,s.bF)(Qt),(0,s.Lk)("div",Jt,[(0,s.bF)(Tt,{class:"sidebar"}),(0,s.Lk)("main",Gt,[(0,s.bF)(r)])])])}}};const Yt=Ht;var Zt=Yt;const es=(0,c.aE)({history:(0,c.LA)(),routes:[{path:"/",name:"login",component:at},{path:"/",component:Zt,children:[{path:"/usuarios",name:"usuarios",component:X,meta:{requireAuth:!0,requireAdmin:!0}},{path:"/usuarios/crear",name:"usuarios.create",component:Wa,meta:{requireAuth:!0,requireAdmin:!0}},{path:"/usuarios/:id/editar",name:"usuarios.edit",component:Vr,meta:{requireAuth:!0,requireAdmin:!0}},{path:"/recursos",name:"recursos",component:je,meta:{requireAuth:!0}},{path:"/recursos/crear",name:"recursos.create",component:Ha,meta:{requireAuth:!0,requireAdmin:!0}},{path:"/recursos/:id/editar",name:"recursos.edit",component:Pr,meta:{requireAuth:!0,requireAdmin:!0}},{path:"/almacenes",name:"almacenes",component:da,meta:{requireAuth:!0}},{path:"/almacenes/crear",name:"almacenes.create",component:sr,meta:{requireAuth:!0}},{path:"/almacenes/:id/editar",name:"almacenes.edit",component:jr,meta:{requireAuth:!0}},{path:"/inventario",name:"inventario",component:be,meta:{requireAuth:!0}},{path:"/solucioness",name:"solucioness",component:Ba,meta:{requireAuth:!0}},{path:"/solucioness/crear",name:"solucioness.create",component:gr,meta:{requireAuth:!0}},{path:"/soluciones/:id/editar",name:"soluciones.edit",component:xo,meta:{requireAuth:!0,requireAdmin:!0}},{path:"/dashboard",name:"dashboard",component:Io,meta:{requireAuth:!0}}]},{path:"/403",name:"403",component:nt},{path:"/NoPermisos",name:"NoPermisos",component:ft}]});es.beforeEach(h);var as={name:"App",components:{}};const rs=(0,t.Ef)(ts);rs.use(o["default"]),rs.mount("#app");const os=(0,R.A)(as,[["render",i]]);var ts=os,ss=(r(5524),r(5790)),ns=(0,ss.$N)();async function ls(){const e=await Promise.resolve().then(r.t.bind(r,8874,23));e.load({google:{families:["Roboto:100,300,400,500,700,900&display=swap"]}})}ls(),(0,t.Ef)(ts).use(es).use(ns).mount("#app")}},a={};function r(o){var t=a[o];if(void 0!==t)return t.exports;var s=a[o]={exports:{}};return e[o].call(s.exports,s,s.exports,r),s.exports}r.m=e,function(){var e=[];r.O=function(a,o,t,s){if(!o){var n=1/0;for(u=0;u<e.length;u++){o=e[u][0],t=e[u][1],s=e[u][2];for(var l=!0,i=0;i<o.length;i++)(!1&s||n>=s)&&Object.keys(r.O).every((function(e){return r.O[e](o[i])}))?o.splice(i--,1):(l=!1,s<n&&(n=s));if(l){e.splice(u--,1);var c=t();void 0!==c&&(a=c)}}return a}s=s||0;for(var u=e.length;u>0&&e[u-1][2]>s;u--)e[u]=e[u-1];e[u]=[o,t,s]}}(),function(){r.n=function(e){var a=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(a,{a:a}),a}}(),function(){var e,a=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__};r.t=function(o,t){if(1&t&&(o=this(o)),8&t)return o;if("object"===typeof o&&o){if(4&t&&o.__esModule)return o;if(16&t&&"function"===typeof o.then)return o}var s=Object.create(null);r.r(s);var n={};e=e||[null,a({}),a([]),a(a)];for(var l=2&t&&o;"object"==typeof l&&!~e.indexOf(l);l=a(l))Object.getOwnPropertyNames(l).forEach((function(e){n[e]=function(){return o[e]}}));return n["default"]=function(){return o},r.d(s,n),s}}(),function(){r.d=function(e,a){for(var o in a)r.o(a,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:a[o]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){r.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)}}(),function(){r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){r.p="/"}(),function(){var e={524:0};r.O.j=function(a){return 0===e[a]};var a=function(a,o){var t,s,n=o[0],l=o[1],i=o[2],c=0;if(n.some((function(a){return 0!==e[a]}))){for(t in l)r.o(l,t)&&(r.m[t]=l[t]);if(i)var u=i(r)}for(a&&a(o);c<n.length;c++)s=n[c],r.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return r.O(u)},o=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];o.forEach(a.bind(null,0)),o.push=a.bind(null,o.push.bind(o))}();var o=r.O(void 0,[504],(function(){return r(1517)}));o=r.O(o)})();
//# sourceMappingURL=app.48704b22.js.map